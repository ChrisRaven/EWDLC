{"version":3,"sources":["../src/framework/Setting.js","../src/framework/Preferences.js","../src/framework/Account.js","../src/framework/SettingsUi.js","../src/framework/TaskStatus.js","../src/framework/ewdlc.js","../src/modules/tabbedChat/Tab.js","../src/modules/tabbedChat/TabbedPrefs.js","../src/modules/tabbedChat/CommandProcessor.js","../src/modules/tabbedChat/TabbedChat.js","../src/modules/SkippableLeaderboard/SkippableLeaderboard.js","../src/modules/ExtraStats/ExtraStats.js","../src/modules/ExtraControls/ExtraControls.js","../src/modules/UiBoxImprovements/UiBoxImprovements.js","../src/modules/SlHacks/SlHacks.js","../src/modules/CellColorPicker/ColorPickerView.js","../src/modules/CellColorPicker/CellColorPicker.js","../src/modules/ProfileWindowChanges/ProfileWindowChanges.js","../src/modules/modules.js","../src/init.js"],"names":["Setting","name","value","dflt","_this","this","_callbacks","Set","_name","_default","_value","getName","getDefault","setDefault","def","registerCallback","callback","add","unregisterCallback","delete","getValue","setValue","forEach","reset","Preferences","ewdlc","_settings","_settingsName","_isInit","_saveSettings","json","localStorage","setItem","JSON","stringify","registerSetting","setting","getSetting","init","$","document","trigger","stored","getItem","settingsJson","parse","_loadSettings","Account","username","_username","_isReady","getUsername","isReady","setReady","val","SettingsUi","_$container","makeContainer","addClass","text","appendTo","makeCheckbox","desc","$setting","$input","attr","hide","prop","checkbox","each","elem","removeClass","change","e","stopPropagation","is","find","click","$firstButton","first","length","insertBefore","parent","makeButton","$button","TaskStatus","normal","frozen","stashed","duplicate","EWDLC","staticDir","_staticDir","preferences","account","modules","settingsUi","intv","setInterval","uid","clearInterval","getResourceUrl","resource","Tab","options","_prefix","prefix","_scope","scope","_unreadMessages","_isClosed","_$textElem","_$tabElem","append","css","getElement","getPrefix","getScope","getUnread","isPMTab","startsWith","isClosed","setName","nameToSet","setActive","active","setUnread","unread","isNaN","$span","children","show","close","outerWidth","open","get","done","data","substring","TabbedPrefs","settings","tc-show-timestamp","tc-show-points-msgs","tc-show-all-in-tabs","tc-show-channels-in-all","tc-enable-unread","tc-show-leaderboard","tc-grayout-messages","tc-allow-backslash-prefix","tc-enable-markup","tc-show-connection-statuses","tc-command-tab","lang","key","set","on","hasOwnProperty","i","CommandProcessor","tabbedChat","boundCallbacks","err","tomni","chat","addMsg","getCellLimit","args","cellId","cell","limit","toLowerCase","parseInt","bind","command","description","usage","unbind","exec","msg","msgSplit","split","bound","params","id","color","originalColors","originalColorUtils_rotate","indexOf","prefs","ColorUtils","rotate","hexToRGB","Cell","colors","custom","rgb","when","threeD","addCell","cellid","center","then","removeCell","getCurrentCell","cellInfo","getCell","info","history","filteredTasks","tasks","filter","task","status","fail","is_hunt","rotation","clone","multiplyScalar","round","floor","x","y","z","join","submitChatMessage","empty","can","gameMode","inspect","duplicates","map","task_id","processWt","counter","lim","wt","newLine","oldCounter","findIndex","inArray","any","help","result","scytheData","count","ret","toString","cleanTasks","potentialTasks","taskArray","index","splice","getJSON","completeData","filterByStatus","t","complete","votes","weight","myTasks","scythe","concat","admin","lowWt","ids","wts","j","push","a2","n","includes","TabbedChat","activeTab","_tabs","pmTabs","chatInput","scopes","container","insertAfter","makeMsg","hasUsername","scopeText","not","trim","target","html","contentNode","isPointMsg","checkTabsShouldShow","tab","$chatInput","animate","bottom","fadeIn","outerHeight","showTabs","fadeOut","shouldBeHidden","scopeIndex","msgText","isCrewMsg","filterMessages","toHide","toShow","toGray","toUngray","grayout","isCommands","checkStamp","toArray","scrollTop","scrollHeight","timestamp","addTab","focus","getActiveTab","coordRegex","openCoord","groups","ui","recenterView","THREE","Vector3","rclickTask","window","getSelection","preventDefault","matched","match","num","location","origin","clickTask","setRemainingChars","Math","max","fastSwitch","ctrlKey","which","hasClass","flags","*","|","_","-","markup","char","tag","prevChr","output","_addRoleTabs","commandProcessor","focusout","MutationObserver","records","record","addedNodes","contextmenu","scopeToSearch","node","input","childNodes","len","nodeType","chr","prevPrevChr","inLen","charAt","wrapper","createElement","innerHTML","replaceChild","applyMarkup","date","Date","hours","getHours","minutes","getMinutes","fullStr","prependTo","addStamp","checkPM","sound","SFX","play","$elem","replaced","replace","remove","checkCoords","observe","getElementsByClassName","childList","attributres","characterData","subtree","off","keydown","keyCode","Keycodes","codes","shift","metaKey","chatMsg","enter","shiftKey","locator","prefixLess","up","down","jumpArg","url","href","results","RegExp","decodeURIComponent","_getParameterByName","jumpToTaskID","replaceState","ws","onmessage","evt","cmd","type","SkippableLeaderboard","original","taskManager","showLeaderboard","ExtraStats","addStat","className","title","currentTimeout","changeToSecond","firstSet","setTimeout","secondSet","changeToFirst","Profile","updateAlwaysVisibleStats","Utils","numberToCondensedSI","number","fit","maxchars","precision","points","trailblazes","cubes","scythes","modeSet","encodeURIComponent","stats","forever","slice","isBigEnough","checkWindowWidth","width","clearTimeout","refresh","rank","joined","country","country_name","trained","newbie","first_timer","language","level","assignRoles","call","resize","ExtraControls","_enlargeButtons","_swapMoveOnAndFlag","_accountReady","Deferred","_settingsReady","toggleEnlargedButtons","toggleClass","toggleSwappedButtons","$flagButton","$moveOnButton","$jumpContainer","detach","ion","$field","cid","setCell","jumpToCell","decreaseBrushSize","increaseBrushSize","$twoD","$borderDiv","borderDivNode","twoDNode","mutations","mutation","attributeName","style","getAttribute","indexOfTransform","thisStyle","myIndexOfTransform","transformPart","myTransformPart","setAttribute","attributes","toggle","firstStartup","originalPlay","dataset_id","b","borderControls","resolve","UiBoxImprovements","$floatingControls","observer","updateCoords","_floatinsp_top","_floatinsp_left","_floatinsp_cube_tab","clamp","min","clampAndSetCoords","top","left","disconnect","getElementById","setCoords","height","parsePx","bindLinkifier","$target","cubesText","cubeNum","takeRecords","linkifyCubes","px","$cubeButton","intervalId","$li","last","ScytheVisionColors","reap","scythed","complete2","review","SlHacks","setColor","selector","setProperty","addEventListener","console","log","ColorPickerView","_defaults","_$mainContainer","_$collapseButton","_$save","_$discard","_$default","_$exit","_isCollapsed","_isExit","_colors","_initialColors","_currentColors","_colorLang","makeAction","$container","fillTopContainer","$topContainer","$colorContainer","$actionContainer","$color","spectrum","showInitial","showInput","preferredFormat","replacerClassName","move","toHexString","makeColors","buildContainers","$bottomContainer","fillBottomContainer","duration","queue","setColors","extend","cache","getColors","getContainer","CellColorPicker","_tasks","_groups","_tasksRequest","_heatmapRequest","_requestsDone","_isOpen","_cell","_originalColorFunc","_originalUpdateFunc","_view","_setting","_order","_spectrumReady","start","abort","resetTaskColors","updateCompleteColoring","tags","ReapGrow","processTasks","processHeatmap","applyColors","stop","hard","save","colorCubes","cubeids","base","blending","render","heatmap","reaped","complete1","complete3","scythefrozen","scythe_frozen","jQuery","cachedScript","dataType","ajax","getView","ProfileWindowChanges","_observer","_$joinedDateSpan","_$profUsername","bio","joinedMoment","moment","nowMoment","fromNow","years","diff","months","days","arr","Modules","interval","found","styleSheets","src","WebSocket","skippableLeaderboard","extraStats","extraControls","uiBoxImprovements","slHacks","cellColorPicker","profileWindowChanges","ready","initModules"],"mappings":"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","sourcesContent":["/**\n * Holds information about a setting\n * @constructor\n * @param {string} name The unique identifier of this setting\n * @param {*} [value] The initial value of this setting\n * @param {*} [dflt] The default value of this setting\n */\nfunction Setting(name, value, dflt) {\n    var _this = this;\n    var _callbacks = new Set();\n    var _name = name;\n    var _default = dflt;\n    var _value = value;\n\n    /**\n     * Returns the name of this setting\n     * \n     * @return {string}\n     */\n    _this.getName = function() {\n        return _name;\n    };\n\n    /**\n     * Gets the default value of this function\n     * \n     * @return {*}\n     */\n    _this.getDefault = function() {\n        return _default;\n    };\n\n    /**\n     * Sets the default value of this function\n     * \n     * @param {*} def the new default value\n     */\n    _this.setDefault = function(def) {\n        _default = def;\n    };\n\n    /**\n     * Adds a callback to be invoked when the value of this setting changes\n     * \n     * @param {settingChanged} callback The callback to add\n     */\n    _this.registerCallback = function(callback) {\n        if(!callback || typeof(callback) !== typeof(Function)) return;\n\n        _callbacks.add(callback);\n    };\n\n    /**\n     * Removes a value change callback\n     * \n     * @param {settingChanged} callback The callback to remove\n     */\n    _this.unregisterCallback = function(callback) {\n        _callbacks.delete(callback);\n    };\n\n    /**\n     * Gets the value held by this setting\n     * \n     * @return {*}\n     */\n    _this.getValue = function() {\n        return _value;\n    };\n\n    /**\n     * Sets the value held by this setting and invokes the callbacks if it's changed\n     * \n     * @param {*} value The value to set\n     */\n    _this.setValue = function(value) {\n        if(_value === value) return;\n\n        _value = value;\n        _callbacks.forEach((callback) => callback(_name, _value));\n    };\n\n    /**\n     * Resets the setting value to its default\n     */\n    _this.reset = function() {\n        _this.setValue(_default);\n    };\n}\n\n/**\n * The callback structure for when a setting changes\n * \n * @callback settingChanged\n * @param {string} name The name of the setting which changed\n * @param {*} value The new value of this setting\n */\n\nexport { Setting }\n","import {Setting} from \"./Setting.js\"\n\n/**\n * Manages and stores settings in local storage\n * \n * @param {Object} ewdlc \n */\nfunction Preferences(ewdlc) {\n    var _this = this;\n    var _settings = {};\n    var _settingsName = \"ewdlc-prefs\";\n    var _isInit = false;\n\n    function _loadSettings() {\n        let stored = localStorage.getItem(_settingsName);\n        if(!stored) return;\n\n        let settingsJson = JSON.parse(stored);\n\n        for(let name in settingsJson) {\n            let setting = _this.getSetting(name);\n\n            if(!setting) continue;\n\n            setting.setValue(settingsJson[name]);\n        }\n    }\n\n    function _saveSettings() {\n        let json = {};\n\n        for(let name in _settings) {\n            json[name] = _settings[name].getValue();\n        }\n\n        localStorage.setItem(_settingsName, JSON.stringify(json));\n    }\n\n    /**\n     * Registers a setting to keep persistent\n     * \n     * @param {Object} setting The setting to register\n     */\n    _this.registerSetting = function(setting) {\n        if(!setting || !(setting instanceof Setting)) return;\n\n        _settings[setting.getName()] = setting;\n        _settings[setting.getName()].registerCallback(_saveSettings);\n    };\n\n    /**\n     * Returns a setting with the given name.\n     * \n     * @param {string} name The name of the setting\n     * @returns {Object}\n     */\n    _this.getSetting = function(name) {\n        return _settings[name];\n    };\n\n    /**\n     * Initializes the class and loads the stored settings\n     */\n    _this.init = function() {\n        if(_isInit) return;\n\n        $(document).trigger(\"ewdlc-preferences-loading\");\n        \n        _loadSettings();\n        \n        $(document).trigger(\"ewdlc-preferences-loaded\");\n\n        _isInit = true;\n    };\n}\n\nexport {Preferences}\n","function Account(username) {\n    var _this = this;\n    var _username = username;\n    var _isReady = false;\n\n    _this.getUsername = function() {\n        return _username;\n    };\n\n    _this.isReady = function() {\n        return _isReady;\n    };\n\n    _this.setReady = function (val) {\n      _isReady = val;\n    };\n}\n\nexport { Account }\n","import { Setting } from \"./Setting.js\"\n\nfunction SettingsUi() {\n    var _this = this;\n    var _$container;\n\n    function makeContainer() {\n        _$container = $(\"<div>\").addClass(\"settings-group invisible\");\n        $(\"<h1>\").text(\"EyeWire DLC\").appendTo(_$container);\n\n        _$container.appendTo(\"#settingsMenu\");\n    }\n\n    _this.makeCheckbox = function(setting, desc) {\n        if(!setting || !(setting instanceof Setting) || !desc) return;\n\n        if(!_$container) makeContainer();\n\n        let $setting = $(\"<div>\").addClass(\"setting\");\n        $(\"<span>\").text(desc).appendTo($setting);\n\n        let $input = $(\"<input>\").attr(\"type\", \"checkbox\").hide().appendTo($setting);\n\n        $input.prop(\"checked\", setting.getValue() ? true : false);\n\n        $input.checkbox().each(function () {\n            var elem = $(this);\n            \n            if (setting.getValue()) {\n                elem.removeClass(\"off\").addClass(\"on\");\n            } else {\n                elem.removeClass(\"on\").addClass(\"off\");\n            }\n        });\n        $input.change(function (e) {\n            e.stopPropagation();\n            var elem = $(this);\n            setting.setValue(elem.is(\":checked\"));\n        });\n        $setting.find(\".checkbox\").click(function (e) {\n            var elem = $input;\n            elem.prop(\"checked\", !elem.is(\":checked\"));\n            elem.change();\n        });\n        $setting.click(function (e) {\n            e.stopPropagation();\n            var elem = $input;\n            elem.prop(\"checked\", !elem.is(\":checked\"));\n            elem.change();\n        });\n\n        var $firstButton = _$container.find(\".setting > .minimalButton\").first();\n\n        if($firstButton.length > 0)\n            $setting.insertBefore($firstButton.parent());\n        else\n            $setting.appendTo(_$container);\n    }\n\n    _this.makeButton = function(name) {\n        if(!name) return;\n\n        if(!_$container) makeContainer();\n\n        let $setting = $(\"<div>\").addClass(\"setting\");\n        let $button = $(\"<div>\").addClass(\"minimalButton\").text(name).appendTo($setting);\n        $setting.appendTo(_$container);\n\n        return $button;\n    }\n}\n\nexport { SettingsUi }\n","var TaskStatus = {\n    normal: 0,\n    frozen: 10,\n    stashed: 6,\n    duplicate: 11\n}\n\nexport {TaskStatus}\n","import {Preferences} from \"./Preferences.js\"\nimport {Account} from \"./Account.js\"\nimport {SettingsUi} from \"./SettingsUi.js\"\n\n/**\n * The main entrypoint of the framework\n */\nfunction EWDLC(staticDir) {\n    var _this = this;\n    var _isInit = false;\n    var _staticDir = staticDir;\n\n    _this.preferences = new Preferences(_this);\n    _this.account = new Account();\n    _this.modules = {};\n    _this.settingsUi = new SettingsUi();\n\n    _this.init = function() {\n        if(_isInit) return;\n\n        _this.preferences.init();\n        let intv = setInterval(function () {\n          if (typeof account === 'undefined' || !account.account.uid) {\n            return;\n          }\n\n          clearInterval(intv);\n          $(document).trigger('ewdlc-account-ready');\n          _this.account.setReady(true);\n          _isInit = true;\n        }, 50);\n    };\n\n    _this.getResourceUrl = function(resource) {\n        return _staticDir + resource;\n    }\n}\n\nexport {EWDLC}\nexport {Preferences} from \"./Preferences.js\"\nexport {Account} from \"./Account.js\"\nexport {Setting} from \"./Setting.js\"\nexport {SettingsUi} from \"./SettingsUi.js\"\nexport {TaskStatus} from \"./TaskStatus.js\"\n","function Tab(options) {\n    options = options || {};\n\n    var _name = options.name;\n    var _prefix = options.prefix;\n    var _scope = options.scope;\n    var _unreadMessages = 0;\n    var _isClosed = false;\n\n    var _this = this;\n    var _$textElem = $(\"<span>\").text(_name);\n    var _$tabElem = $(\"<div id='tc-\" + options.name + \"'>\").addClass(\"chatTab\").append(_$textElem)\n    .append($(\"<span>\").css(\"margin-left\", \"3px\").addClass(\"sl-badge\").text(\"0\").hide())\n    .append($(\"<i>\").addClass(\"fa\").addClass(\"fa-close\").css(\"margin-left\", \"3px\").hide());\n\n    _this.getElement = function() {\n        return _$tabElem;\n    };\n\n    _this.getPrefix = function () {\n        return _prefix;\n    };\n\n    _this.getScope = function() {\n        return _scope;\n    };\n\n    _this.getName = function() {\n        return _name;\n    };\n\n    _this.getUnread = function() {\n        return _unreadMessages;\n    };\n\n    _this.isPMTab = function() {\n        return _prefix.startsWith(\"/pm\");\n    };\n\n    _this.isClosed = function() {\n        return _isClosed;\n    }\n\n    _this.setName = function(nameToSet) {\n        _name = nameToSet;\n        _$tabElem.text(name);\n    };\n\n    _this.setActive = function(active) {\n        if(active) {\n            _unreadMessages = 0;\n            _$tabElem.addClass(\"active\");\n        }\n        else {\n            _$tabElem.removeClass(\"active\");\n        }\n    };\n\n    _this.setUnread = function(unread) {\n        if(!isNaN(unread) && unread >= 0) {\n            _unreadMessages = unread;\n            let $span = _$tabElem.children(\"span.sl-badge\");\n            $span.text(_unreadMessages);\n\n            if(_unreadMessages > 0) {\n                $span.show();\n            } else {\n                $span.hide();\n            }\n        }\n    };\n\n    _this.close = function() {\n        _$tabElem.removeClass(\"active\").addClass(\"disabled\");\n        _$tabElem.css(\"margin-left\", -_$tabElem.outerWidth() + \"px\");\n        _isClosed = true;\n    };\n\n    _this.open = function() {\n        _$tabElem.removeClass(\"disabled\");\n        _$tabElem.css(\"margin-left\", \"0px\");\n        _isClosed = false;\n    };\n\n    if(_prefix.startsWith(\"/pm\")) {\n        _$tabElem.children(\"i\").show();\n        $.get(\"/1.0/player/\" + _scope + \"/bio\").done(function(data) {\n            if($(\".chatInput\").val().startsWith(_prefix)) {\n                $(\".chatInput\").val(\"/pm \" + data.username + \" \" + $(\".chatInput\").val().substring(_prefix.length));\n            }\n            _scope = data.username;\n            _prefix = \"/pm \" + data.username + \" \";\n            _$textElem.text(_scope);\n        });\n    }\n}\n\nexport {Tab}\n","import {Setting} from \"../../framework/Setting.js\"\n\nfunction TabbedPrefs(callback) {\n    var settings = {\n        \"tc-show-timestamp\": new Setting(\"tc-show-timestamp\", true),\n        \"tc-show-points-msgs\": new Setting(\"tc-show-points-msgs\", true),\n        \"tc-show-all-in-tabs\": new Setting(\"tc-show-all-in-tabs\", true),\n        \"tc-show-channels-in-all\": new Setting(\"tc-show-channels-in-all\", true),\n        \"tc-enable-unread\": new Setting(\"tc-enable-unread\", true),\n        \"tc-show-leaderboard\": new Setting(\"tc-show-leaderboard\", true),\n        \"tc-grayout-messages\": new Setting(\"tc-grayout-messages\", false),\n        \"tc-allow-backslash-prefix\": new Setting(\"tc-allow-backslash-prefix\", true),\n        \"tc-enable-markup\": new Setting(\"tc-enable-markup\", true),\n        \"tc-show-connection-statuses\": new Setting(\"tc-show-connection-statuses\", false),\n        \"tc-command-tab\": new Setting(\"tc-command-tab\", true)\n    };\n\n    var lang = [\n        {key: \"tc-show-timestamp\", lang: \"Timestamps\"},\n        {key: \"tc-show-points-msgs\", lang: \"Points Messages\"},\n        {key: \"tc-show-all-in-tabs\", lang: \"General Chat visible in tabs\"},\n        {key: \"tc-show-channels-in-all\", lang: \"Group Chats visible in General\"},\n        {key: \"tc-enable-unread\", lang: \"Unread Messages Counter\"},\n        {key: \"tc-show-leaderboard\", lang: \"Leaderboard after cube submission\"},\n        {key: \"tc-grayout-messages\", lang: \"All hidden messages as faded\"},\n        {key: \"tc-allow-backslash-prefix\", lang: \"Backslash as command prefix\"},\n        {key: \"tc-enable-markup\", lang: \"Markup\"},\n        {key: \"tc-show-connection-statuses\", lang: \"Connection statuses\"},\n        {key: \"tc-command-tab\", lang: \"Command tab\"}\n    ]\n\n    var _this = this;\n\n    _this.set = function(setting, value) {\n        settings[setting].setValue(value);\n    };\n\n    _this.get = function(setting) {\n        return settings[setting].getValue();\n    };\n\n    $(document).on(\"ewdlc-preferences-loading\", function() {\n        for(var setting in settings) {\n            if (settings.hasOwnProperty(setting)) {\n                ewdlc.preferences.registerSetting(settings[setting]);\n                settings[setting].registerCallback(callback);\n            }\n        }\n    });\n\n    $(document).on(\"ewdlc-preferences-loaded\", function() {\n        for(let i in lang) {\n            if (lang.hasOwnProperty(i)) {\n                ewdlc.settingsUi.makeCheckbox(settings[lang[i].key], lang[i].lang);\n            }\n        }\n    })\n}\n\nexport {TabbedPrefs}","import {TaskStatus} from \"../../framework/TaskStatus.js\"\n\nfunction CommandProcessor(tabbedChat) {\n    var self = this;\n    var boundCallbacks = {};\n\n    this.bind = function(command, description, usage, callback) {\n        boundCallbacks[command] = {};\n        boundCallbacks[command].description = description;\n        boundCallbacks[command].usage = usage;\n        boundCallbacks[command].callback = callback;\n    };\n\n    this.unbind = function(command) {\n        if(boundCallbacks[command]) {\n            delete boundCallbacks[command];\n        }\n    };\n\n    this.exec = function(msg) {\n        if(!msg) return false;\n\n        var msgSplit = msg.split(' ');\n\n        if(msgSplit.length === 0) return false;\n\n        var callback = boundCallbacks[msgSplit[0]];\n\n        if(callback) {\n            callback.callback(msgSplit);\n            return true;\n        }\n\n        return false;\n    };\n\n    function err() {\n        tomni.chat.addMsg({}, \"An error was encountered while running this command. Please wait a moment and try again.\");\n    }\n\n    function filterByStatus(tasks) {\n        return tasks.filter(function(task) {return task.status != TaskStatus.frozen && task.status != TaskStatus.stashed});\n    }\n\n    function help(args) {\n        tomni.chat.addMsg({}, \"------------------\");\n        tomni.chat.addMsg({}, \"Tabbed Chat commands:\");\n\n        for(var key in boundCallbacks) {\n            if(key === \"/help\") continue;\n\n            var bound = boundCallbacks[key];\n            var msg = key;\n\n            if(bound.description || bound.usage) msg += \": \";\n            if(bound.description) msg += bound.description;\n            if(bound.description && bound.usage) msg += \", Usage: \";\n            if(bound.usage) msg += bound.usage;\n            tomni.chat.addMsg({}, msg);\n        }\n\n        tomni.chat.addMsg({}, \"------------------\");\n    }\n\n    function getCellLimit(args) {\n        var cellId = tomni.cell;\n        var limit = 15;\n\n        if(args.length >= 2) {\n            if(args[1].toLowerCase() === \"this\") {\n                cellId = tomni.cell;\n            } else {\n                cellId = parseInt(args[1]);\n                if(isNaN(cellId) || cellId <= 0) {\n                    return {cellId: -1, limit: limit};\n                }\n            }\n        }\n\n        if(args.length >= 3) {\n            limit = parseInt(args[2]);\n            if(isNaN(limit)) {\n                return {cellId: -1, limit: limit};\n            }\n        }\n\n        if(limit <= 0) {\n            limit = 99999;\n        }\n\n        return {cellId: cellId, limit: limit};\n    }\n\n    function lowWt(args) {\n        var processWt = function(counter, lim, wt, frozen, data) {\n            var newLine = 0;\n            var oldCounter = counter;\n            var msg = \"\";\n            if(data[wt] && data[wt].length > 0 && data[wt].findIndex(function(elem) {return $.inArray(elem.task_id, frozen) >= 0;})) {\n                msg += \"Weight \" + wt + \":\\n  \";\n\n                for(var i = data[wt].length-1; i >= 0; i--) {\n                    if($.inArray(data[wt][i].task_id, frozen) >= 0) continue;\n\n                    msg += \"#\" + data[wt][i].task_id;\n\n                    if(counter < lim - 1 || i !== 0) {\n                        msg += \"  \";\n                    }\n\n                    newLine++;\n                    counter++;\n                    if(counter === lim)\n                        break;\n\n                    if(newLine === 4 && i > 0) {\n                        msg += \"\\n \";\n                        newLine = 0;\n                    }\n                }\n            }\n\n            return {msg: msg, counter: counter, any: oldCounter != counter};\n        };\n\n        var help = function() {\n            tomni.chat.addMsg({}, \"Usage: /low-wt [cell=this] [limit=15]\");\n        };\n\n        if(!account.can('scout')) {\n            tomni.chat.addMsg({}, \"You must be a scout or higher to use this command.\");\n            return;\n        }\n\n        var result = getCellLimit(args);\n\n        if(result.cellId < 0) {\n            help(); return;\n        }\n\n        var cellId = result.cellId;\n        var limit = result.limit;\n\n        if(args.length > 3) {\n            help(); return;\n        }\n\n        tomni.chat.history.add(args.join(' '));\n\n        $.get(\"/1.0/cell/\" + cellId + \"/heatmap/scythe\").done(function(scytheData) {\n            var frozen = scytheData.frozen;\n\n            $.get(\"/1.0/cell/\" + cellId + \"/heatmap/low-weight?weight=3\").done(function(data) {\n                var count = 0;\n\n                var msg = \"Low weight cubes in cell \" + cellId + \" (limit \" + limit + \"): \";\n\n                for(var i = 0; i < 3; i++) {\n                    var ret = processWt(count, limit, i.toString(), frozen, data);\n                    if(ret.any) {\n                        msg += \"\\n \";\n                    }\n                    msg += ret.msg;\n                    count = ret.counter;\n\n                    if(count >= limit) break;\n                }\n\n                if(count === 0) {\n                    tomni.chat.addMsg({}, \"There are no low weight cubes in cell \" + cellId);\n                } else {\n                    tomni.chat.addMsg({}, msg);\n                }\n            }).fail(err);\n        }).fail(err);\n    }\n\n    function clear(args) {\n        $(\".chatMsgContainer\").empty();\n        tomni.chat.addMsg({}, \"The chat has been cleared.\");\n    }\n\n    function scInfo(args) {\n        var help = function() {\n            tomni.chat.addMsg({}, \"Usage: /sc-info [cell=this] [limit=15]\");\n        };\n\n        var cleanTasks = function(potentialTasks, taskArray) {\n            for(var i = 0; i < taskArray.length; i++) {\n                var index = potentialTasks.indexOf(taskArray[i]);\n\n                if(index >= 0) {\n                    potentialTasks.splice(index, 1);\n                }\n            }\n\n            return potentialTasks;\n        };\n\n        if(!account.can('scythe mystic admin')) {\n            tomni.chat.addMsg({}, \"You must be a scythe or higher to use this command.\");\n            return;\n        }\n\n        var result = getCellLimit(args);\n\n        if(result.cellId < 0) {\n            help(); return;\n        }\n\n        var cellId = result.cellId;\n        var limit = result.limit;\n\n        if(args.length > 3) {\n            help(); return;\n        }\n\n        tomni.chat.history.add(args.join(' '));\n        tomni.chat.addMsg({}, \"Please wait while Grim's minions collect some data...\");\n\n        $.when($.getJSON(\"/1.0/cell/\" + cellId + \"/tasks\"), $.getJSON(\"/1.0/cell/\" + cellId + \"/heatmap/scythe\"),\n               $.getJSON(\"/1.0/cell/\" + cellId + \"/tasks/complete/player\"))\n            .done(function(tasks, scytheData, completeData) {\n                tasks = filterByStatus(tasks[0].tasks);\n                scytheData = scytheData[0];\n                completeData = completeData[0];\n\n                var potentialTasks = tasks.map(t => t.id);\n                var frozen = scytheData.frozen || [];\n                var complete = scytheData.complete || [];\n\n                for(var i = 0; i < complete.length; i++) {\n                    var cur = complete[i];\n                    if(cur.votes < 2) continue;\n\n                    var index = potentialTasks.indexOf(complete[i].id);\n\n                    if(index >= 0) {\n                        potentialTasks.splice(index, 1);\n                    }\n                }\n\n                cleanTasks(potentialTasks, tasks.filter(t => t.weight < 3).map(t => t.id));\n                cleanTasks(potentialTasks, frozen);\n\n                var myTasks = completeData.scythe[account.account.uid.toString()] || [];\n                myTasks = myTasks.concat(completeData.admin[account.account.uid.toString()] || []);\n\n                cleanTasks(potentialTasks, myTasks);\n\n                var count = 0;\n\n                var msg = \"Scythe info for cell \" + cellId + \" (limit \" + limit + \"):\\n\";\n                msg += \"Your SC count: \" + myTasks.length + \"\\n\";\n                msg += \"Cubes you can SC: \" + potentialTasks.length + \"\\n\";\n\n                if(potentialTasks.length > 0) {\n                    msg += \"List:\\n \";\n\n                    for(var i = 0; i < potentialTasks.length; i++) {\n                        msg += \"#\" + potentialTasks[i] + \" \";\n\n                        count++;\n                        if(count === limit)\n                            break;\n                    }\n                }\n\n                tomni.chat.addMsg({}, msg);\n            })\n            .fail(err);\n    }\n\n    function lowWtSC(args) {\n        // source: https://stackoverflow.com/questions/1885557/simplest-code-for-array-intersection-in-javascript#comment77733737_1885569\n        let intersection = function (a1, a2) {\n            return a1.filter(n => a2.includes(n));\n        }\n\n        if(!account.can('scythe mystic admin')) {\n            tomni.chat.addMsg({}, \"You must be a scythe or higher to use this command.\");\n            return;\n        }\n\n        var result = getCellLimit(args);\n\n        if(result.cellId < 0) {\n            return;\n        }\n\n        var cellId = result.cellId;\n        var limit = result.limit;\n\n        if(args.length > 3) {\n            return;\n        }\n\n        tomni.chat.history.add(args.join(' '));\n\n\n        $.when($.getJSON(\"/1.0/cell/\" + cellId + \"/heatmap/low-weight?weight=3\"),\n               $.getJSON(\"/1.0/cell/\" + cellId + \"/tasks/complete/player\"))\n            .done(function (lowWt, completeData) {\n                lowWt = lowWt[0];\n                completeData = completeData[0];\n\n                let myTasks = completeData.scythe[account.account.uid.toString()] || [];\n                myTasks = myTasks.concat(completeData.admin[account.account.uid.toString()] || []);\n\n                let ids = [];\n                for (let i = 0; i < 3; i++) {\n                    let wts = lowWt[i];\n                    for (let j = 0; j < wts.length; j++) {\n                        ids.push(wts[j].task_id);\n                    }\n                }\n\n                let result = intersection(myTasks, ids);\n\n                var count = 0;\n\n                var msg = \"Low weight SC info for cell \" + cellId + \" (limit \" + limit + \"):\\n\";\n                msg += \"Cubes you completed with low weight: \" + result.length + \"\\n\";\n\n                if(result.length > 0) {\n                    msg += \"List:\\n \";\n\n                    for(var i = 0; i < result.length; i++) {\n                        msg += \"#\" + result[i] + \" \";\n\n                        count++;\n                        if(count === limit)\n                            break;\n                    }\n                }\n\n                tomni.chat.addMsg({}, msg);\n            })\n            .fail(err);\n    }\n\n    \n    function addCell(args) {\n        let params, id, color;\n        let originalColors;\n        let originalColorUtils_rotate;\n\n        for(let i = 1; i < args.length; i++) {\n            if (args[i].indexOf('#') !== -1) {\n                params = args[i].split('#');\n                id = parseInt(params[0], 10);\n                color = params[1];\n            }\n            else {\n                id = parseInt(args[i], 10);\n                color = false;\n            }\n\n            if (color) {\n                if (tomni.prefs.get('plasticize')) {\n                    originalColorUtils_rotate = ColorUtils.rotate;\n                    ColorUtils.rotate = function () {\n                        return ColorUtils.hexToRGB(color);\n                    };\n                }\n                else {\n                    originalColors = Cell.colors;\n                    Cell.colors = {\n                        custom: {\n                            rgb: ColorUtils.hexToRGB(color)\n                        }\n                    };\n                }\n            }\n\n            if(id) {\n                $.when(tomni.threeD.addCell({cellid: id, center: true}))\n                .then(function (cell) {\n                    if (tomni.prefs.get('plasticize')) {\n                        ColorUtils.rotate = originalColorUtils_rotate;\n                    }\n                    else {\n                        Cell.colors = originalColors;\n                    }\n                });\n            }\n        }\n    }\n\n    function removeCell(args) {\n        for(var i = 1; i < args.length; i++) {\n            var id = parseInt(args[i], 10);\n            if(!isNaN(id)) {\n                tomni.threeD.removeCell(id);\n            }\n        }\n    }\n\n    function hideCell() {\n        tomni.getCurrentCell().hide();\n    }\n\n    function showCell() {\n        tomni.getCurrentCell().show();\n    }\n\n    function cellSize(args) {\n        var cellInfo = tomni.threeD.getCell(tomni.cell).info;\n        tomni.chat.history.add(args[0]);\n\n        $.get(\"/1.0/cell/\" + tomni.cell + \"/tasks\").done(function(data) {\n            var filteredTasks = data.tasks.filter(function(task) {return task.status != TaskStatus.stashed});\n            tomni.chat.addMsg({}, cellInfo.name + \" is \" + filteredTasks.length + \" cube\" + (data.tasks.length !== 1 ? \"s\" : \"\") + \" big.\");\n        }).fail(err);\n    }\n\n    function cubeDupes(args) {\n        if(!account.can('scout scythe mystic admin')) {\n            tomni.chat.addMsg({}, \"You must be a scout or higher to use this command.\");\n            return;\n        }\n\n        tomni.chat.history.add(args[0]);\n\n        if(!tomni.gameMode || !tomni.task.inspect) {\n            tomni.chat.addMsg({}, \"You must be inspecting a cube to use this command.\");\n            return;\n        }\n\n        if(tomni.task.duplicates.length === 0) {\n            tomni.chat.addMsg({}, \"There are no duplicates in this cube.\");\n            return;\n        }\n\n        var msg = \"Duplicates in the current cube:\\n \";\n        msg += tomni.task.duplicates.map(function(e) { return \"#\" + e.task_id;}).join(' ');\n        tomni.chat.addMsg({}, msg);\n    }\n\n    function huntGuess(args) {\n        if(!tomni.getCurrentCell().info.is_hunt) {\n            tomni.chat.addMsg({}, \"You must be in a hunt cell to use this command.\");\n            return;\n        }\n\n        var center = tomni.center.rotation.clone().multiplyScalar(100).round().multiplyScalar(1/100).floor();\n        center = [center.x, center.y, center.z];\n        center = center.join(\" \");\n\n        var msg = \"/pm thehunt \" + center;\n        tomni.chat.submitChatMessage(msg);\n    }\n\n    function markup() {\n        tomni.chat.addMsg({}, 'Type: ・・Some text・・ to apply markup.');\n        tomni.chat.addMsg({}, ' ');\n        tomni.chat.addMsg({}, '\"・・\" cany be any of the following: ');\n        tomni.chat.addMsg({}, '**    bold');\n        tomni.chat.addMsg({}, '||    italic');\n        tomni.chat.addMsg({}, '__    underline');\n        tomni.chat.addMsg({}, '--    strikethrough');\n        tomni.chat.addMsg({}, ' ');\n        tomni.chat.addMsg({}, 'e.g. __text__ will give you \"text\" word underlined.');\n        tomni.chat.addMsg({}, ' ');\n        tomni.chat.addMsg({}, 'Symbols CAN be combined, e.g. **a ||b** c||');\n        tomni.chat.addMsg({}, 'will give you bold \"a\", bold & cursive \"b\" and cursive \"c\"');\n        tomni.chat.addMsg({}, ' ');\n    }\n\n    this.bind(\"/help\", \"\", \"\", help);\n    this.bind(\"/add-cell\", \"Adds one or more cells to the overview\", \"/add-cell Cell ID 1[#hhhhhh] [Cell ID 2[#hhhhhh]] ..., where hhhhhh is a hex color code\", addCell);\n    this.bind(\"/remove-cell\", \"Removes one or more cells from the overview\", \"/remove-cell Cell ID 1 [Cell ID 2] ...\", removeCell);\n    this.bind(\"/show-cell\", \"Shows the current cell (if it was hidden using /hide-cell)\", \"\", showCell);\n    this.bind(\"/hide-cell\", \"Hides the current cell\", \"\", hideCell);\n    this.bind(\"/size\", \"Shows the size of the current cell\", \"\", cellSize);\n    this.bind(\"/guess\", \"Submits your current coordinates as a hunt guess\", \"\", huntGuess);\n    this.bind(\"/clear\", \"Clears the chat\", \"\", clear);\n    this.bind(\"/markup\", \"Shows available markup tags\", \"\", markup);\n    if(account.can('scout scythe mystic admin')) {\n        this.bind(\"/dupe\", \"Lists the duplicates in the current cube\", \"\", cubeDupes);\n    }\n    if(account.can('scythe mystic admin')) {\n        this.bind(\"/low-wt\", \"Lists low weight cubes in cell\", \"/low-wt [cell=this] [limit=15]\", lowWt);\n        this.bind(\"/sc-info\", \"Shows count of the SC you've done, the amount you can do, and lists cube IDs with SC < 2, wt >= 3\", \"/sc-info [cell=this] [limit=15]\", scInfo);\n        this.bind(\"/low-wt-sc\", \"Shows count and list of the SC you've done, where wt < 3\", \"/low-wt-sc [cell=this] [limit=15]\", lowWtSC);\n    }\n}\n\nexport {CommandProcessor}\n","import {Tab} from \"./Tab.js\"\nimport {TabbedPrefs} from \"./TabbedPrefs.js\"\nimport {CommandProcessor} from \"./CommandProcessor.js\"\nimport {Setting} from \"../../framework/Setting.js\"\n\n/* global Keycodes:false */\n\nfunction TabbedChat() {\n    var _tabs = [];\n    var pmTabs = [];\n    var activeTab;\n    var _this = this;\n    var chatInput = $(\".chatInput\");\n    var scopes = [\"(scouts)\", \"(mystics)\", \"(mods)\", \"(mentors)\", \"(admins)\"];\n\n    // Create the container\n    var container = $(\"<div>\").addClass(\"tabList\").insertAfter(\".chatInput\");\n\n    _this.addTab = function (name, prefix, scope) {\n        var tab = new Tab({name: name, prefix: prefix, scope: scope});\n        container.append(tab.getElement());\n        \n        tab.getElement().on(\"click.tabbedChat\", function (e) {\n            if(activeTab === tab) {\n                return;\n            }\n\n            activeTab.setActive(false);\n            tab.setActive(true);\n            tab.setUnread(0);\n            e.stopPropagation();\n\n            // Change the prefix if the chat input is empty\n            if(!chatInput.val().trim() ||\n                chatInput.val().startsWith(\"/pm \") ||\n                _tabs.findIndex(function (elem) { return chatInput.val().trim() === elem.getPrefix().trim(); }) >= 0\n              ) {\n                chatInput.val(tab.getPrefix());\n            }\n            activeTab = tab;\n\n            chatInput.focus();\n            filterMessages();\n\n            $(\".chatMsgContainer\").scrollTop($(\".chatMsgContainer\")[0].scrollHeight);\n        });\n        tab.getElement().children(\"i\").on(\"click.tabbedChat\", function (e) {\n            tab.close();\n            _tabs[0].getElement().click();\n            e.stopPropagation();\n\n            checkTabsShouldShow();\n        });\n\n        _tabs.push(tab);\n\n        checkTabsShouldShow();\n\n        return tab;\n    };\n\n    this.prefs = new TabbedPrefs(updateSettings);\n\n    _this.getActiveTab = function() {\n        return activeTab;\n    };\n\n    function _getParameterByName(name, url) {\n        if (!url) url = window.location.href;\n        name = name.replace(/[\\[\\]]/g, \"\\\\$&\");\n        let regex = new RegExp(\"[?&]\" + name + \"(=([^&#]*)|&|#|$)\"),\n            results = regex.exec(url);\n        if (!results) return null;\n        if (!results[2]) return '';\n        return decodeURIComponent(results[2].replace(/\\+/g, \" \"));\n    };\n\n    function makeMsg(elem) {\n        var username = elem.children(\".userName\").text();\n        var hasUsername = elem.children(\".userName\").length !== 0;\n        var scopeText = elem.children(\".dialogNobody\").not(\".tc-timestamp,.tc-msg-text\").text().trim();\n        var target = scopeText.substring(1, scopeText.length - 1);\n        var content = elem.find('.actualText').html();\n\n        var msg = {\n            username: username,\n            hasUsername: hasUsername,\n            scopeText: scopeText,\n            target: target,\n            contentNode: elem.find('.actualText')\n        };\n\n        return msg;\n    }\n\n    function isPointMsg(text) {\n        return (text.includes(\" earned \") && text.includes(\" points\")) ||\n            text.includes(\" trailblazed a cube\") || text.includes(\" scythed a cube for\") ||\n            text.includes(\" scouted a cube for\") ||\n            text.includes(\" has joined!\") || text.includes(\" has left!\");\n    }\n\n    function checkTabsShouldShow() {\n        if(openTabsCount() > 1) {\n            showTabs();\n        } else {\n            hideTabs();\n        }\n    }\n\n    function openTabsCount() {\n        return _tabs.filter(function(tab) {return !tab.isClosed();}).length;\n    }\n\n    function showTabs() {\n        let $chatInput = $('.chatInput');\n\n        $chatInput.animate({bottom: '50px'}, {complete: function() {container.fadeIn();}});\n        $('.chatMsgContainer').animate({bottom: (50 + $chatInput.outerHeight(true)) + 'px'});\n    }\n\n    function hideTabs() {\n        container.fadeOut(function() {\n            let $chatInput = $('.chatInput');\n\n            $chatInput.animate({bottom: '10px'});\n            $('.chatMsgContainer').animate({bottom: (10 + $chatInput.outerHeight(true)) + 'px'});\n        });\n    }\n\n    function isCrewMsg(text) {\n        return text.includes(\" joined crew \");\n    }\n\n    function shouldBeHidden(msg, elem) {\n        var username = msg.username.toLowerCase();\n        var hasUsername = msg.hasUsername;\n        var scopeText = msg.scopeText;\n        var target = msg.target.toLowerCase();\n\n        var scopeIndex = scopes.indexOf(scopeText);\n\n        if(activeTab.getName() === \"All\") {\n            if(hasUsername && scopeText && !_this.prefs.get(\"tc-show-channels-in-all\"))\n                return true;\n\n            if(!_this.prefs.get(\"tc-show-points-msgs\")) {\n                var text = elem.find(\".dialogNobody\").text();\n\n                if(isPointMsg(text)) {\n                    return true;\n                }\n            }\n\n            return false;\n        }\n\n        if(activeTab.getName() === \"Commands\") {\n            var msgText = elem.find(\".dialogNobody\").text();\n            if(hasUsername || isPointMsg(msgText) || isCrewMsg(msgText)) return true;\n            if(elem.find(\".special,.generic\").length > 0) return true;\n\n            return false;\n        }\n\n        if(hasUsername) {\n            if(scopeIndex >= 0) {\n                return scopeText !== activeTab.getScope();\n            }\n            if(!scopeText && _this.prefs.get(\"tc-show-all-in-tabs\") && !activeTab.isPMTab())\n                return false;\n            if((scopeText === \"(private)\" && activeTab.getScope().toLowerCase() === username) ||\n               (pmTabs.indexOf(target) >= 0 && activeTab.getScope().toLowerCase() === target)) {\n                return false;\n            }\n        }\n\n        if(!hasUsername && !activeTab.isPMTab()) {\n            return isPointMsg(elem.find(\".dialogNobody\").text());\n        }\n\n        if(elem.find(\".special\").length > 0 && !activeTab.isPMTab())\n            return false;\n\n        return true;\n    }\n\n    function filterMessages() {\n        var toHide = [];\n        var toShow = [];\n        var toGray = [];\n        var toUngray = [];\n\n        var grayout = _this.prefs.get(\"tc-grayout-messages\");\n        var isCommands = activeTab.getName() === \"Commands\";\n\n        $(\".chatMsg\").each(function() {\n            var msg = makeMsg($(this));\n            checkStamp($(this), msg);\n            if(shouldBeHidden(msg, $(this))) {\n                if(msg.hasUsername && grayout && !isCommands) {\n                    toGray.push($(this));\n                    toShow.push($(this));\n                } else {\n                    toHide.push($(this));\n                }\n            }\n            else {\n                if(msg.hasUsername && grayout) {\n                    toUngray.push($(this));\n                }\n\n                toShow.push($(this));\n            }\n        });\n\n        $(toHide).map(function() {return this.toArray();}).hide();\n        $(toShow).map(function() {return this.toArray();}).show();\n\n        $(toGray).map(function() {return this.toArray();}).find(\".tc-msg-text\").addClass(\"dialogNobody\");\n        $(toUngray).map(function() {return this.toArray();}).find(\".tc-msg-text\").removeClass(\"dialogNobody\");\n\n        $(\".chatMsgContainer\").scrollTop($(\".chatMsgContainer\")[0].scrollHeight);\n    }\n\n    function updateSettings() {\n        if(!_this.prefs.get(\"tc-enable-unread\")) {\n            for(var i = 0; i < _tabs.length; i++) {\n                _tabs[i].setUnread(0);\n            }\n        }\n\n        if(!_this.prefs.get(\"tc-grayout-messages\")) {\n            $(\".chatMsg\").find(\".tc-msg-text\").removeClass(\"dialogNobody\");\n        } else {\n            $(\".chatMsg\").show();\n        }\n\n        filterMessages();\n    }\n\n    function checkPM(msg) {\n        var username;\n        var hasUsername = msg.hasUsername;\n        var scopeText = msg.scopeText;\n\n        if(!hasUsername || !scopeText) return;\n\n        if(scopeText === \"(private)\") {\n            username = msg.username;\n        } else if(scopes.indexOf(scopeText) < 0 ) {\n            username = scopeText.substring(1, scopeText.length - 1);\n        } else {\n            return;\n        }\n\n        if(pmTabs.indexOf(username.toLowerCase()) < 0) {\n            pmTabs.push(username.toLowerCase());\n            _this.addTab(username, \"/pm \" + username + \" \", username);\n        }\n    }\n\n    function checkStamp(elem, msg) {\n        if(!msg.hasUsername) return;\n\n        var timestamp = elem.find(\".tc-timestamp\");\n\n        if(_this.prefs.get(\"tc-show-timestamp\"))\n            timestamp.show();\n        else\n            timestamp.hide();\n    }\n\n    var coordRegex = /&lt;([0-9]+)(,| |, )([0-9]+)(,| |, )([0-9]+)&gt;/g;\n\n    function openCoord() {\n        let groups = coordRegex.exec($(this).html());\n\n        if(groups) {\n            let x = parseInt(groups[1], 10);\n            let y = parseInt(groups[3], 10);\n            let z = parseInt(groups[5], 10);\n            tomni.ui.recenterView(new THREE.Vector3(-x, -y, -z));\n        }\n    }\n\n    function checkCoords($elem) {\n        let html = $elem.html();\n\n        let replaced = html.replace(coordRegex, function(match) {\n            return '<span class=\"link coords\">' + match + '</span>';\n        });\n\n        if (replaced !== html) {\n            $elem.remove();\n\n            $(\"<div>\").addClass(\"chatMsg\").html(replaced).appendTo($(\".chatMsgContainer\"));\n            return true;\n        }\n\n        return false;\n    }\n\n    function addStamp(elem) {\n        var date = new Date();\n        var hours = date.getHours().toString();\n        if(hours.length == 1) {\n            hours = \"0\" + hours;\n        }\n        var minutes = date.getMinutes().toString();\n        if(minutes.length == 1) {\n            minutes = \"0\" + minutes;\n        }\n        var fullStr = hours + \":\" + minutes;\n\n        $(\"<span>\").addClass(\"dialogNobody\").addClass(\"tc-timestamp\").html(fullStr + \"&nbsp;\").prependTo(elem);\n    }\n\n    function rclickTask(e) {\n        if(window.getSelection().toString() !== \"\") {\n            return;\n        }\n\n        e.preventDefault();\n        e.stopPropagation();\n\n        var matched = $(this).text().match(/^(t|task|tid)?#(\\d+)$/i);\n        var num = parseInt(matched[2],10);\n\n        window.open(window.location.origin + \"?tcJumpTaskId=\" + num);\n    }\n\n    function clickTask(e) {\n        $(this).addClass(\"clicked\");\n        e.stopPropagation();\n    }\n\n    function setRemainingChars() {\n        $(\"#charLeft\").text(Math.max(0, 180 - $(\".chatInput\").val().length));\n    }\n\n    function fastSwitch(e) {\n        if(e.ctrlKey) {\n            if(e.which === 188 || e.which === 190) {\n                e.preventDefault();\n                e.stopPropagation();\n\n                var index = _tabs.indexOf(activeTab);\n                if(e.which === 188) {\n                    index--;\n                    while(index >= 0 && _tabs[index].getElement().hasClass(\"disabled\")) {\n                        index--;\n                    }\n\n                    if(index >= 0) _tabs[index].getElement().click();\n                } else if(e.which === 190) {\n                    index++;\n                    while(index < _tabs.length && _tabs[index].getElement().hasClass(\"disabled\")) {\n                        index++;\n                    }\n\n                    if(index < _tabs.length) _tabs[index].getElement().click();\n                }\n            }\n        }\n    }\n\n\n    let flags = {\n        '*': false,\n        '|': false,\n        '_': false,\n        '-': false\n    };\n\n    function markup(char, tag, prevChr) {\n        let output = '';\n        if (prevChr === char) {\n            output = flags[char] ? '</' + tag + '>' : '<' + tag + '>';\n            flags[char] = !flags[char];\n        }\n\n        return output;\n    }\n\n    function applyMarkup(node) {\n        let children = node[0].childNodes;\n        let input;\n        for (let i = 0, len = children.length; i < len; i++) {\n            if (children[i].nodeType === 3) { // TEXT NODE\n                input = children[i].data;\n\n                let chr = '', prevChr = '', prevPrevChr = '', output = '';\n\n                for (let i = 0, inLen = input.length; i < inLen; i++) {\n                    prevPrevChr = prevChr;\n                    prevChr = chr;\n                    chr = input.charAt(i);\n\n                    switch (chr) {\n                        case '*':\n                            output += markup('*', 'b', prevChr);\n                            break;\n                        case '|':\n                            output += markup('|', 'i', prevChr);\n                            break;\n                        case '_':\n                            output += markup('_', 'u', prevChr);\n                            break;\n                        case '~':\n                            output += markup('~', 'strike', prevChr);\n                            break;\n                        case '<':\n                            output += '&lt;';\n                            break;\n                        default:\n                            // prevPrevChr, to check, if the prevChr was part of a 2-char markup, or just a regular character\n                            if (['*', '|', '_', '~'].indexOf(prevChr) !== -1 && prevPrevChr !== prevChr) {\n                                output += prevChr;\n                            }\n                            output += chr;\n                    }\n                }\n\n                // to add last char, if it was one of those used in markup, but wasn't part of a tag\n                if (['*', '|', '_', '-'].indexOf(chr) !== -1 && prevChr !== chr) {\n                    output += chr;\n                }\n\n                let wrapper = document.createElement('span');\n                wrapper.innerHTML = output;\n                node[0].replaceChild(wrapper, children[i]);\n            }\n        }\n    }\n\n\n\n    // Add the default tab\n    activeTab = _this.addTab(\"All\", \"\", \"\");\n    activeTab.setActive(true);\n\n    // Add any tab per role\n    function _addRoleTabs() {\n        if(account.can('scythe mystic admin')) {\n            _this.addTab(\"Commands\", \"\", \"\");\n        }\n        if(account.can('scout scythe mystic admin')) {\n            _this.addTab(\"Scouts\", \"/gm scouts \", \"(scouts)\");\n        }\n        if(account.can('mystic admin')) {\n            _this.addTab(\"Mystics\", \"/gm mystics \", \"(mystics)\");\n        }\n        if(account.can('moderator admin')) {\n            _this.addTab(\"Mods\", \"/gm mods \", \"(mods)\");\n        }\n        if(account.can('mentor admin')) {\n            _this.addTab(\"Mentors\", \"/gm mentors \", \"(mentors)\");\n        }\n        if(account.can('admin')) {\n            _this.addTab(\"Admins\", \"/gm admins \", \"(admins)\");\n        }\n\n        checkTabsShouldShow();\n\n        let prefs = localStorage.getItem('ewdlc-prefs');\n        if (prefs) {\n            prefs = JSON.parse(prefs);\n            if(!prefs['tc-command-tab']) {\n                $('#tc-Commands').hide();\n            }\n        }\n    }\n    \n    if(ewdlc && ewdlc.account.isReady()) {\n        _this.commandProcessor = new CommandProcessor(_this);\n        _addRoleTabs();\n    } else {\n        $(document).on(\"ewdlc-account-ready\", function() {\n            _addRoleTabs(); \n            _this.commandProcessor = new CommandProcessor(_this);\n        });\n    }\n\n    chatInput\n        .focus(function () {\n            filterMessages();\n            $(\"#charLeft\").fadeIn(200);\n        })\n        .focusout(function () {\n            $(\"#charLeft\").fadeOut(200);\n        });\n\n    var mutationObserver = new MutationObserver(moCallback);\n    mutationObserver.observe(document.getElementsByClassName('chatMsgContainer')[0], {\n        childList: true,\n        attributres: false,\n        characterData: false,\n        subtree: false\n    });\n    \n    function moCallback(records) {\n        var record = records[0];\n        if (!record.addedNodes) return;\n        var elem = $(record.addedNodes[0]);\n\n        elem.find(\".link.coords\").on(\"click.tabbedChat\", openCoord);\n        if(elem.find(\".tc-timestamp\").length > 0 || elem.find(\".link.coords\").length > 0) return;\n\n        elem.find(\".taskid\").on(\"click.tabbedChat\", clickTask).contextmenu(rclickTask);\n\n        var msg = makeMsg(elem);\n        var scopeToSearch = \"\";\n        var index;\n\n        if(msg.hasUsername) {\n            if (_this.prefs.get('tc-enable-markup')) {\n                applyMarkup(msg.contentNode);\n            }\n            addStamp(elem);\n            elem.find(\".actualText\").addClass(\"tc-msg-text\");\n        }\n        checkStamp(elem, msg);\n        checkPM(msg);\n\n        if(shouldBeHidden(msg, elem)) {\n            if(msg.hasUsername && _this.prefs.get(\"tc-grayout-messages\") && activeTab.getName() !== \"Commands\") {\n                elem.find(\".actualText\").addClass(\"dialogNobody\");\n            } else {\n                elem.hide();\n            }\n\n            if(msg.hasUsername) {\n                if(msg.username !== account.account.username) {\n                }\n\n                var sound = \"chat_public\";\n\n                if(elem.find(\".playerCallOut.me\").length > 0) {\n                    sound = \"chat_private\";\n                }\n\n                if(scopes.indexOf(msg.scopeText) >= 0) {\n                    scopeToSearch = msg.scopeText;\n                }\n                else if(msg.scopeText === \"(private)\") {\n                    sound = \"chat_private\";\n                    scopeToSearch = msg.username;\n                }\n                else if(pmTabs.indexOf(msg.target) >= 0) {\n                    scopeToSearch = msg.target;\n                }\n\n                if(chatInput.is(\":focus\")) {\n                    SFX.play(sound);\n                }\n\n                index = _tabs.findIndex(function(elem) { return elem.getScope() == scopeToSearch; });\n                if(_this.prefs.get(\"tc-enable-unread\")) {\n                    _tabs[index].setUnread(_tabs[index].getUnread()+1);\n                }\n            }\n        }\n\n        if(msg.scopeText === \"(private)\") {\n            scopeToSearch = msg.username;\n        }\n        else if(pmTabs.indexOf(msg.target) >= 0) {\n            scopeToSearch = msg.target;\n        }\n\n        index = _tabs.findIndex(function(elem) { return elem.getScope() == scopeToSearch; });\n        _tabs[index].open();\n\n        checkTabsShouldShow();\n\n        chatInput.removeClass(\"pulsing\");\n        \n        checkCoords(elem);\n    }\n\n    chatInput.off(\"keydown\").keydown(function(e) {\n        chatInput.click();\n        if(e.ctrlKey) {\n            fastSwitch(e);\n        }\n        if(e.keyCode !== Keycodes.codes.shift && !e.metaKey && !e.ctrlKey) {\n            e.stopPropagation();\n        }\n        var chatMsg = $(this).val();\n\n        if(e.keyCode === Keycodes.codes.enter) {\n            if(!!e.shiftKey || e.metaKey || e.ctrlKey) {\n                e.stopPropagation();\n            }\n\n            $(this).val(\"\");\n            tomni.chat.history.locator = -1;\n\n            var index = _tabs.findIndex(function(elem) {return elem.getName() !== \"All\" && elem.getName() !== \"Commands\" && chatMsg.startsWith(elem.getPrefix());});\n\n            if(index >= 0) {\n                var prefixLess = chatMsg.substring(_tabs[index].getPrefix().length);\n                if(prefixLess.startsWith(\"/\")) {\n                    $(this).val(_tabs[index].getPrefix());\n\n                    if(prefixLess.trim() === \"/help\") {\n                        tomni.chat.submitChatMessage(prefixLess);\n                        _this.commandProcessor.exec(prefixLess);\n                        return false;\n                    }\n\n                    if(_this.commandProcessor.exec(prefixLess))\n                        return false;\n                    else\n                        return tomni.chat.submitChatMessage(prefixLess);\n                }\n            }\n\n            if(chatMsg.startsWith(\"/\") || (_this.prefs.get(\"tc-allow-backslash-prefix\") && chatMsg.startsWith(\"\\\\\"))) {\n                if(chatMsg.startsWith(\"\\\\\"))\n                    chatMsg = \"/\" + chatMsg.substring(1);\n                \n                if(chatMsg.trim() === \"/help\") {\n                    tomni.chat.submitChatMessage(chatMsg);\n                    _this.commandProcessor.exec(chatMsg);\n                    return false;\n                }\n\n                if(_this.commandProcessor.exec(chatMsg))\n                    return false;\n            }\n\n            return tomni.chat.submitChatMessage(chatMsg);\n        }\n        else if(e.keyCode === Keycodes.codes.up) {\n            return tomni.chat.history.up(this);\n        }\n        else if(e.keyCode === Keycodes.codes.down) {\n            return tomni.chat.history.down(this);\n        }\n\n        return true;\n    });\n    chatInput.on(\"keydown keypress\", function(e) {\n        e.stopPropagation();\n    });\n\n    $(document).on(\"keydown.tabbedChat\", fastSwitch);\n\n    var jumpArg = _getParameterByName(\"tcJumpTaskId\");\n    if(jumpArg) {\n        $(\".threeDPanel\").on(\"cell-meshes-loaded.tabbedChat\", function() {\n            tomni.jumpToTaskID(parseInt(jumpArg, 10));\n            $(this).off(\"cell-meshes-loaded.tabbedChat\");\n        });\n        history.replaceState({}, \"Cube Jump\", window.location.origin);\n    }\n\n    $(\"<div>\").addClass(\"charLeftContainer\").insertAfter(\".chatInput\").append($(\"<span>\").text(\"180\").attr(\"id\", \"charLeft\").hide());\n    $(\".chatInput\").on(\"input.tabbedChat change.tabbedChat\", setRemainingChars);\n    setInterval(setRemainingChars, 500); // hack to still update remaining chars if the textarea's value gets set using .val()\n\n    ws.onmessage = function (evt) {\n      let data = evt.data;\n      let username;\n\n      if(!_this.prefs.get(\"tc-show-connection-statuses\")) {\n        return;\n      }\n\n      if (!data) {\n        return;\n      }\n      \n      data = JSON.parse(data);\n      \n      if (data.cmd === 'alert') {\n        username = data.params.attr.username;\n        if (username === 'LynneC' || username === 'KrzysztofKruk') {\n          return;\n        }\n\n        if (data.params.type === 'connect') {\n          tomni.chat.addMsg(null, username + ' has joined!');\n        }\n        else if (data.params.type === 'disconnect') {\n          tomni.chat.addMsg(null, username + ' has left!');\n        }\n      }\n      \n    };\n}\n\nlet ws;\n\nfunction TabbedChatInit() {\n    $(\"<link>\").attr(\"rel\", \"stylesheet\")\n               .attr(\"type\", \"text/css\")\n               .attr(\"href\", ewdlc.getResourceUrl(\"/css/ewdlc.min.css?v=2\"))\n               .appendTo(\"head\");\n\n    var interval = setInterval(function() {\n        var found = false;\n        for(var i = 0; i < document.styleSheets.length; i++) {\n            if(document.styleSheets[i].href && document.styleSheets[i].href.includes(\"/css/ewdlc.min.css?v=2\"))\n                found = true;\n        }\n\n        if(!found) return;\n\n        $(\".chatInput\").trigger(\"keyup\");\n        clearInterval(interval);\n    }, 500);\n\n    $('<script>', {src: 'https://use.fontawesome.com/7745d29f5b.js'}).appendTo('body');\n\n    ws = new WebSocket('wss://eyewire.org/chat');\n\n    ewdlc.modules.tabbedChat = ewdlc.modules.tabbedChat || new TabbedChat();\n\n}\n\nexport {TabbedChatInit}\nexport {TabbedChat}\nexport {Tab} from \"./Tab.js\"\nexport {TabbedPrefs} from \"./TabbedPrefs.js\"\n","function SkippableLeaderboard() {\n    var original = tomni.taskManager.ui.showLeaderboard;\n    tomni.taskManager.ui.showLeaderboard = function(data) {\n        if(!ewdlc.modules.tabbedChat.prefs.get(\"tc-show-leaderboard\")) {\n            data.callback(\"proceed\");\n            $(\"#edit-cube-loader\").css(\"opacity\", \"0\");\n            return;\n        }\n        original(data);\n    };\n}\n\nfunction SkippableLeaderboardInit() {\n    ewdlc.modules.skippableLeaderboard = ewdlc.modules.skippableLeaderboard || new SkippableLeaderboard();\n}\n\nexport {SkippableLeaderboard}\nexport {SkippableLeaderboardInit}\n","function ExtraStats() {\n    function addStat(className, id, title) {\n        $(\"<div>\").addClass(\"icon\").attr(\"title\", title).addClass(className).appendTo(\"#funStats\");\n        $(\"<div>\").attr(\"id\", id).text(\"No Data\").appendTo(\"#funStats\");\n    }\n\n    var currentTimeout;\n\n    function changeToSecond() {\n        firstSet.css(\"opacity\", \"0\");\n        setTimeout(function() {\n            firstSet.appendTo(\"#funStats\");\n            firstSet.css(\"visibility\", \"hidden\");\n            secondSet.css(\"visibility\", \"visible\");\n            secondSet.css(\"opacity\", \"1\");\n\n            currentTimeout = setTimeout(changeToFirst, 10000);\n        }, 350);\n    }\n\n    function changeToFirst() {\n        secondSet.css(\"opacity\", \"0\");\n        setTimeout(function() {\n            secondSet.appendTo(\"#funStats\");\n            secondSet.css(\"visibility\", \"hidden\");\n            firstSet.css(\"visibility\", \"visible\");\n            firstSet.css(\"opacity\", \"1\");\n\n            currentTimeout = setTimeout(changeToSecond, 10000);\n        }, 350);\n    }\n\n    Profile.updateAlwaysVisibleStats = function(t) {\n        t = t || {};\n        var i = function(e) {\n            return Utils.numberToCondensedSI({\n                number: e,\n                fit: 6,\n                maxchars: 6,\n                precision: 0\n            });\n        };\n        if(t.username && t.username.toLowerCase() === \"grimreaper\") {\n            $(\"#pointsValue\").addClass(\"grimReaperPoints\").html(\"&infin;\");\n            $(\"#cubesValue\").addClass(\"grimReaperPoints\").html(\"&infin;\");\n            $(\"#trailblazingsValue\").addClass(\"grimReaperPoints\").html(\"&infin;\");\n            $(\"#funStats #scythedCubes\").addClass(\"grimReaperPoints\").html(\"&infin;\");\n            $(\"#funStats #completedCubes\").addClass(\"grimReaperPoints\").html(\"&infin;\");\n        } else {\n            $(\"#pointsValue\").text(i(t.points));\n            $(\"#trailblazingsValue\").text(i(t.trailblazes));\n            $(\"#cubesValue\").text(i(t.cubes));\n            if(t.scythes) {\n                $(\"#funStats #scythedCubes\").text(i(t.scythes));\n            }\n            if(t.complete) {\n                $(\"#funStats #completedCubes\").text(i(t.complete));\n            }\n        }\n        $(\"#acc\").text(t.username);\n    };\n\n    tomni.taskManager.ui.modeSet = function() {\n        $.getJSON(\"/1.0/player/\" + encodeURIComponent(account.account.username) + \"/stats\", function(e) {\n            account.account.stats = e;\n            Profile.updateAlwaysVisibleStats({\n                username: account.account.username,\n                points: e.forever.points,\n                cubes: e.forever.cubes,\n                trailblazes: e.forever.trailblazes,\n                scythes: e.forever.scythes,\n                complete: e.forever.complete\n            });\n        });\n    };\n\n    var firstSet = $(\"#funStats div\").slice(0, 6);\n    var secondSet;\n    var isBigEnough = true;\n\n    account.refresh = function(t) {\n        return $.getJSON(\"/1.0/player/describe/\").done(function(i) {\n            if(i && i.id) {\n                account.account.username = i.username;\n                account.account.uid = i.id;\n                account.account.rank = i[\"class\"];\n                account.account.joined = new Date(i.joined);\n                account.account.country = i.country;\n                account.account.country_name = i.country_name;\n                account.account.trained = i.trained;\n                account.account.newbie = i.newbie;\n                account.account.first_timer = i.first_timer;\n                account.account.language = i.language;\n                account.account.level = i.level || 0;\n                account.assignRoles(i);\n                $.getJSON(\"/1.0/player/\" + account.account.username + \"/stats\", function(t) {\n                    Profile.updateAlwaysVisibleStats({\n                        username: i.username,\n                        points: t.forever.points,\n                        cubes: t.forever.cubes,\n                        trailblazes: t.forever.trailblazes,\n                        scythes: t.forever.scythes,\n                        complete: t.forever.complete\n                    });\n                    account.account.stats = t;\n                });\n                $(\"#acc\").html($(\"#logoutButtons\").html());\n                if(t) t.call(this);\n                $(document).trigger(\"account-info-ready\", [account]);\n            }\n        });\n    };\n\n    function checkWindowWidth() {\n        if($(window).width() >= 1920) {\n            if(!isBigEnough) {\n                isBigEnough = true;\n\n                clearTimeout(currentTimeout);\n                firstSet.css(\"visibility\", \"visible\");\n                firstSet.css(\"opacity\", \"1\");\n                if(secondSet) {\n                    secondSet.appendTo($(\"#funStats\"));\n                    secondSet.css(\"visibility\", \"visible\");\n                    secondSet.css(\"opacity\", \"1\");\n                }\n            }\n        } else {\n            if(isBigEnough) {\n                isBigEnough = false;\n                if(secondSet) {\n                    currentTimeout = setTimeout(changeToSecond, 10000);\n                    secondSet.css(\"visibility\", \"hidden\");\n                    secondSet.css(\"opacity\", \"0\");\n                }\n            }\n        }\n    }\n\n    $(document).on(\"ewdlc-account-ready\", function() {\n        if(account.can('scout scythe mystic admin')) {\n            addStat(\"scytheIcon\", \"scythedCubes\", \"Cubes Scythed\");\n            secondSet = $(\"#funStats div\").slice(6, 8);\n        }\n        if(account.can('scythe mystic admin')) {\n            addStat(\"completedCubesIcon\", \"completedCubes\", \"Cubes Completed\");\n            secondSet = $(\"#funStats div\").slice(6, 10);\n        }\n        checkWindowWidth();\n        account.refresh();\n    });\n\n    $(document).resize(checkWindowWidth);\n}\n\nfunction ExtraStatsInit() {\n    ewdlc.modules.extraStats = ewdlc.modules.extraStats || new ExtraStats();\n}\n\nexport {ExtraStats}\nexport {ExtraStatsInit}\n","import { Setting } from \"../../framework/Setting.js\"\n\nfunction ExtraControls() {\n    var _enlargeButtons = new Setting(\"tc-enlarge-reap-buttons\", false, false);\n    var _swapMoveOnAndFlag = new Setting(\"tc-swap-moveon-flag\", false, false);\n\n    var _accountReady = $.Deferred();\n    var _settingsReady = $.Deferred();\n\n    function jumpToCell() {\n        if (!account.can('mystic admin')) return;\n\n        let $jumpContainer = $(\"#jumpContainer\").clone().detach();\n        let $input = $jumpContainer.find(\"input\");\n        let $button = $jumpContainer.find(\"button\");\n        $jumpContainer[0].id = 'additionalJumpContainer';\n        $button.insertBefore($input);\n\n        // Modify the attributes\n        $input.attr(\"placeholder\", \"           Enter Cell #\");\n        $input.attr(\"id\", \"cellJumpField\");\n\n        $button.attr(\"disabled\", \"true\");\n        $button.attr(\"id\", \"cellJumpButton\");\n\n        // Set the event handlers\n        $input.ion('keydown keypress', function (e) {\n\t\t\te.stopPropagation();\n        });\n\n        $button.click(function (e) {\n\t\t\te.preventDefault();\n\n\t\t\tvar $field = $input.removeClass('error');\n\n\t\t\tvar cid = parseInt($field.val(), 10);\n\n\t\t\tif (isNaN(cid)) {\n\t\t\t\t$field.addClass('error');\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\ttomni.setCell({id: cid}).fail(function () {\n\t\t\t\t$field.addClass('error');\n\t\t\t});\n\n\t\t\treturn false;\n\t\t});\n        \n        $input.ion('change keyup input', function (e) {\n\t\t\te.stopPropagation();\n\n\t\t\t$button.prop('disabled', $(this).val().length === 0);\n\n\t\t\tif (e.keyCode !== Keycodes.codes.enter) {\n\t\t\t\t$(this).removeClass('error');\n\t\t\t} else {\n\t\t\t\t$button.click();\n\t\t\t}\n\t\t});\n\n        // Reattach the element\n        $jumpContainer.appendTo(\"#cubeFinder\");\n    }\n\n    function brushControls() {\n\n        $(\"<div>\").attr(\"title\", \"Decrease brush size (q)\").addClass(\"fob brush dec\")\n            .click(function(e) {\n            e.stopPropagation();\n            SFX.play(\"button\");\n            tomni.prefs.decreaseBrushSize();\n        }).insertAfter($(\"#mst-slider-container\"));\n        $(\"<div>\").attr(\"title\", \"Increase brush size (e)\").addClass(\"fob brush inc\")\n            .click(function(e) {\n            e.stopPropagation();\n            SFX.play(\"button\");\n            tomni.prefs.increaseBrushSize();\n        }).insertAfter($(\"#mst-slider-container\"));\n    }\n\n    function borderControls() {\n        var $twoD = $(\"#twoD\");\n        var $borderDiv = $(\"<div>\")\n        .addClass(\"twoD-borders\")\n        .hide()\n        .insertAfter($twoD);\n        var borderDivNode = $borderDiv.get(0);\n        var twoDNode = $twoD.get(0);\n\n        var observer = new MutationObserver(function(mutations){mutations.forEach(function(mutation){\n            if(mutation.type !== \"attributes\" || mutation.attributeName !== \"style\") return;\n\n            var style = twoDNode.getAttribute(\"style\");\n            var indexOfTransform = style.indexOf(\"transform\");\n            var thisStyle = borderDivNode.getAttribute(\"style\");\n            var myIndexOfTransform = thisStyle.indexOf(\"transform\");\n\n            if(indexOfTransform >= 0) {\n                var transformPart = style.substring(indexOfTransform, style.indexOf(\";\", indexOfTransform)+1);\n                var myTransformPart = thisStyle.substring(myIndexOfTransform, thisStyle.indexOf(\";\", myIndexOfTransform)+1);\n\n                if(myIndexOfTransform >= 0) {\n                    borderDivNode.setAttribute(\"style\", thisStyle.replace(myTransformPart, transformPart));\n                } else {\n                    borderDivNode.setAttribute(\"style\", thisStyle + transformPart);\n                }\n            }\n        });});\n\n        observer.observe($twoD.get(0), {attributes: true});\n\n        var $button = $(\"<div>\").attr(\"title\", \"Toggle spawn borders (b)\").addClass(\"fob\").text(\"SB\")//.addClass(\"fob show-borders\")\n        .click(function(e) {\n            e.stopPropagation();\n            SFX.play(\"button\");\n            $borderDiv.toggle();\n        }).appendTo($(\".twoD-controls\"));\n\n        var firstStartup = true;\n        var originalPlay = tomni.play;\n        tomni.play = function(data) {\n            if(tomni.getCurrentCell().info.dataset_id !== 1) {\n                $button.hide();\n            } else {\n                $button.show();\n            }\n\n            if(firstStartup) {\n                setTimeout(function(){$borderDiv.hide();}, 500);\n                firstStartup = false;\n            } else {\n                $borderDiv.hide();\n            }\n\n            originalPlay(data);\n        };\n\n        $(document).on(\"keydown.spawnBorders\", function(e) {\n            if(!tomni.gameMode || tomni.getCurrentCell().info.dataset_id !== 1) return;\n\n            if(e.keyCode === Keycodes.codes.b) {\n                e.preventDefault();\n                SFX.play(\"button\");\n                $borderDiv.toggle();\n            }\n        });\n    }\n\n    function resetCubePositionControls() {\n        $('.twoD-controls').append('<div id=\"reset-cube-position\" title=\"Reset cube position\" class=\"fob reset-cube-position\"></div>');\n        $('#reset-cube-position').click(function (e) {\n            resetCubePosition();\n        });\n    }\n\n    function toggleEnlargedButtons(name, value) {\n        $(\".reapAuxButton\").toggleClass(\"tcEnlargeButtons\", value);\n        $(\"#editActions\").toggleClass(\"tcEnlargeButtons\", value);\n    };\n\n    function toggleSwappedButtons(name, value) {\n        var $flagButton = $(\"#flagCube\");\n        var $moveOnButton = $(\"#actionInspectReviewContinue\");\n\n        if(value) {\n            $flagButton.insertAfter($(\"#deselectSeedGT\")).addClass(\"reapAuxButton enabled tcFlagSwapped\").removeClass(\"reaperButton\").empty();\n            $moveOnButton.insertAfter($(\"#saveGT\")).addClass(\"reaperButton tcFlagSwapped\").removeClass(\"reapAuxButton enabled\").text(\"Move On\");\n\n            $(\"<i>\").addClass(\"fa fa-flag-o\").appendTo($flagButton);\n        } else {\n            $flagButton.insertAfter($(\"#saveGT\")).addClass(\"reaperButton\").removeClass(\"reapAuxButton enabled tcFlagSwapped\").empty().text(\"Flag\");\n            $moveOnButton.insertAfter($(\"#deselectSeedGT\")).addClass(\"reapAuxButton enabled\").removeClass(\"reaperButton tcFlagSwapped\").empty();\n        }\n\n        toggleEnlargedButtons(\"\", _enlargeButtons.getValue());\n    }\n/*\n    camera.fov = cameraProps.fov;\n    camera.position.set(cameraProps.position.x, cameraProps.position.y, cameraProps.position.z);\n    camera.rotation.set(cameraProps.rotation.x, cameraProps.rotation.y, cameraProps.rotation.z);\n    camera.up.set(cameraProps.up.x, cameraProps.up.y, cameraProps.up.z);\n    tomni.center.rotation.set(tomniRotation.x, tomniRotation.y, tomniRotation.z);\n    tomni.threeD.zoom = threeDZoom;\n    camera.updateProjectionMatrix();\n    tomni.forceRedraw();*/\n\n\n    function resetCubePosition() {\n        let camera = tomni.threeD.getCamera();\n        camera.fov = 40;\n        let center = tomni.getCurrentCell().getCenter();\n        let shift = tomni.getCurrentCell().info.dataset_id === 1 ? 256 : 2014;\n        switch (tomni.twoD.axis) {\n            case 'x':\n                camera.position.set(-500, 0, 0);\n                camera.up.set(0, 0, -1);\n                // tomni.center.rotation.set(center.x + shift, center.y, center.z);\n                break;\n            case 'y':\n                camera.position.set(0, 500, 0);\n                camera.up.set(0, 0, -1);\n                // tomni.center.rotation.set(center.x, center.y + shift, center.z);\n                break;\n            case 'z':\n                camera.position.set(0, 0, -500);\n                camera.up.set(0, -1, 0);\n                // tomni.center.rotation.set(center.x, center.y, center.z + shift);\n                break;\n        }\n\n        camera.rotation.set(0, 1, 1);\n        tomni.center.rotation = tomni.getCurrentCell().getCenter();//.set(1, 1, 1);\n        tomni.threeD.zoom = 750;\n        camera.updateProjectionMatrix();\n        tomni.forceRedraw();\n    }\n\n    $(document).on(\"ewdlc-account-ready\", function() {\n        jumpToCell();\n        brushControls();\n        borderControls();\n        // resetCubePositionControls();\n\n        _accountReady.resolve();\n    });\n\n    $(document).on(\"ewdlc-preferences-loading.extraControls\", function() {\n        ewdlc.preferences.registerSetting(_enlargeButtons);\n        ewdlc.preferences.registerSetting(_swapMoveOnAndFlag);\n        _enlargeButtons.registerCallback(toggleEnlargedButtons);\n    });\n\n    $(document).on(\"ewdlc-preferences-loaded.extraControls\", function() {\n        _settingsReady.resolve();\n    });\n\n    $.when(_accountReady, _settingsReady).then(function() {\n        if(account.can('scout scythe mystic admin')) {\n            ewdlc.settingsUi.makeCheckbox(_enlargeButtons, \"Enlarge in-cube buttons\");\n        }\n\n        // if(ewdlc.account.isScythe() || !ewdlc.account.isScout()) return;\n        if (account.can('scythe mystic admin')) return;\n\n        _swapMoveOnAndFlag.registerCallback(toggleSwappedButtons);\n        ewdlc.settingsUi.makeCheckbox(_swapMoveOnAndFlag, \"Swap move on/flag buttons\");\n        toggleSwappedButtons(\"\", _swapMoveOnAndFlag.getValue());\n    });\n}\n\nfunction ExtraControlsInit() {\n    ewdlc.modules.extraControls = ewdlc.modules.extraControls || new ExtraControls();\n}\n\nexport {ExtraControls}\nexport {ExtraControlsInit}\n","import {Setting} from \"../../framework/Setting.js\"\n\nfunction UiBoxImprovements() {\n    var $floatingControls = $(\"#cubeInspectorFloatingControls\");\n    var observer = new MutationObserver(mutated);\n\n    var _floatinsp_top = new Setting(\"uibox-top\", null, null);\n    var _floatinsp_left = new Setting(\"uibox-left\", null, null);\n    var _floatinsp_cube_tab = new Setting(\"uibox-cube-tab\", false, false);\n\n    function clamp(number, min, max) {\n        return Math.max(min, Math.min(number, max));\n    }\n\n    function setCoords(top, left) {\n        observer.disconnect();\n        $floatingControls.css(\"top\", top + \"px\");\n        $floatingControls.css(\"left\", left + \"px\");\n        observer.observe(document.getElementById(\"cubeInspectorFloatingControls\"), {attributes: true});\n    }\n\n    function clampAndSetCoords(top, left) {\n        top = clamp(top, 0, $(document).height() - $floatingControls.outerHeight());\n        left = clamp(left, 0, $(document).width() - $floatingControls.outerWidth());\n\n        setCoords(top, left);\n\n        _floatinsp_top.setValue(top);\n        _floatinsp_left.setValue(left);\n    }\n\n    function updateCoords() {\n        var top = $floatingControls.css(\"top\");\n        var left = $floatingControls.css(\"left\");\n\n        if(top === \"auto\" || left === \"auto\" || left.includes(\"%\")) return;\n\n        clampAndSetCoords(parsePx(top), parsePx(left));\n    }\n\n    function linkifyCubes(elem, observer) {\n        var cubesText = elem.text();\n\n        if(cubesText === '-')\n            return;\n\n        elem.empty();\n\n        var cubes = cubesText.split(\", \");\n\n        for(var i = 0; i < cubes.length; i++) {\n            var $span = $(\"<span>\").addClass(\"link\");\n            var cubeNum = parseInt(cubes[i], 10);\n\n            $span.text(cubes[i]);\n            $span.data(\"target\", cubeNum);\n\n            $span.click(function(e) {\n                $(this).addClass(\"clicked\");\n                tomni.jumpToTaskID($(this).data(\"target\"));\n                e.stopPropagation();\n            });\n\n            elem.append($span);\n            if(i < cubes.length - 1)\n                elem.append(\", \");\n        }\n\n        observer.takeRecords();\n    }\n\n    function bindLinkifier(elem) {\n        elem.addClass(\"tc\");\n\n        var observer = new MutationObserver(function(mutations) {\n            mutations.forEach(function(mutation) {\n                if(mutation.addedNodes.length == 0) return;\n                \n                var $target = $(mutation.target);\n\n                if(elem.children(\".link\").length > 0) return;\n\n                linkifyCubes($target, observer);\n            });\n        });\n\n        observer.observe(elem[0], { childList: true, characterData: true });\n    }\n\n    function parsePx(px) {\n        return parseInt(px.replace(\"px\", \"\").trim(), 10);\n    }\n\n    function mutated(mutations) {\n        mutations.forEach(function(mutation) {\n            if(mutation.type !== \"attributes\" || mutation.attributeName !== \"style\") return;\n\n            updateCoords();\n        });\n    }\n\n    $(document).on(\"ewdlc-preferences-loading\", function() {\n        ewdlc.preferences.registerSetting(_floatinsp_top);\n        ewdlc.preferences.registerSetting(_floatinsp_left);\n        ewdlc.preferences.registerSetting(_floatinsp_cube_tab);\n    });\n\n    $(document).on(\"ewdlc-preferences-loaded\", function() {\n        if(_floatinsp_top.getValue() != null && _floatinsp_left.getValue() != null) {\n            clampAndSetCoords(_floatinsp_top.getValue(),_floatinsp_left.getValue());\n        }\n    \n        var $cubeButton = $floatingControls.find(\".info > .cube.minimalButton\");\n    \n        if(_floatinsp_cube_tab.getValue()) {\n            $cubeButton.click();\n        } else {\n            $floatingControls.find(\".info > .player.minimalButton\").click();\n        }\n    \n        var tabObserver = new MutationObserver(function(mutations) {mutations.forEach(function(mutation) {\n            if(mutation.type !== \"attributes\" || mutation.attributeName !== \"class\") return;\n    \n            _floatinsp_cube_tab.setValue($cubeButton.hasClass(\"selected\"));\n        });});\n        tabObserver.observe($cubeButton.get(0), {attributes: true});\n    \n        observer.observe(document.getElementById(\"cubeInspectorFloatingControls\"), {attributes: true});\n    \n        $(document).resize(function() {\n            updateCoords();\n        });\n    });\n\n    // The selector might be empty at this point, so create an interval to check it every half a second\n    var intervalId = setInterval(function () {\n        if($floatingControls.length == 0) {\n            $floatingControls = $(\"#cubeInspectorFloatingControls\");\n            return;\n        }\n        $floatingControls.find(\"div.panel.player.selected\").bind(\"DOMNodeInserted\", \"li\", function () {\n            let $li = $(this).children().last();\n            let text = $li.text();\n\n            let color;\n\n            if($li.hasClass(\"admin\")) {\n                color = Cell.ScytheVisionColors.reap;\n            } else if($li.hasClass(\"scythe\")) {\n                color = Cell.ScytheVisionColors.scythed;\n            } else if($li.hasClass(\"complete\")) {\n                color = Cell.ScytheVisionColors.complete2;\n            } else if($li.hasClass(\"scout\")) {\n                color = Cell.ScytheVisionColors.review;\n            }\n\n            if(color) {\n                $li.css(\"color\", color);\n            }\n\n            if (text === \"No Cube Selected\") return;\n\n            $li.on(\"click.floatinsp\", function () {\n                Profile.show({\n                    username: text\n                });\n            });\n        });\n\n        bindLinkifier($floatingControls.find(\".panel.cube > .parent_task > .value\"));\n        bindLinkifier($floatingControls.find(\".panel.cube > .child_tasks > .value\"));\n\n        clearInterval(intervalId);\n    }, 500);\n}\n\nfunction UiBoxImprovementsInit() {\n    ewdlc.modules.uiBoxImprovements = ewdlc.modules.uiBoxImprovements || new UiBoxImprovements();\n}\n\nexport {UiBoxImprovements}\nexport {UiBoxImprovementsInit}\n","function SlHacks() {\n    function setColor(selector, color) {\n        $(selector).each(function() {\n            this.style.setProperty(\"color\", color, \"important\");\n        });\n    }\n\n    var intervalId = setInterval(function () {\n        // Stop SL bug with R toggling review mode\n        if (!document.getElementById(\"slPanel\")) return;\n\n        document.getElementById(\"slPanel\").addEventListener(\"keypress\", function (e) {\n            e.stopPropagation();\n        });\n        console.log(\"Fixed Scouts' Log Review button bug.\");\n        clearInterval(intervalId);\n\n        // Set Need Scythe/Admin button colors to match cell colors\n        setColor(\".sl-need-admin\", Cell.ScytheVisionColors.reap);\n        setColor(\".sl-need-scythe\", Cell.ScytheVisionColors.scythed);\n\n    }, 1000);\n}\n\nfunction SlHacksInit() {\n    ewdlc.modules.slHacks = ewdlc.modules.slHacks || new SlHacks();\n}\n\nexport { SlHacks }\nexport { SlHacksInit }\n","function ColorPickerView(_defaults) {\n    var _this = this;\n    var _isInit = false;\n\n    var _isCollapsed = false;\n    var _isExit = false;\n\n    var _$mainContainer;\n    var _$collapseButton;\n\n    var _$save;\n    var _$discard;\n    var _$default;\n    var _$exit;\n\n    var _colors = {};\n    var _initialColors = {};\n    var _currentColors = {};\n\n    var _colorLang = [\n        {key: \"complete1\", lang: \"1 SC Vote\"},\n        {key: \"complete2\", lang: \"2 SC Votes\"},\n        {key: \"complete3\", lang: \"Admin SC\"},\n        {key: \"review\", lang: \"Review\"},\n        {key: \"scythed\", lang: \"Scythed\"},\n        {key: \"reap\", lang: \"Reaped\"},\n        {key: \"frozen\", lang: \"Frozen\"},\n        {key: \"scythefrozen\", lang: \"Scythe Frozen\"},\n        {key: \"duplicate\", lang: \"Duplicate\"},\n        {key: \"base\", lang: \"Base\"}\n    ];\n\n    function makeAction($container, name) {\n        return $(\"<div>\").addClass(\"minimalButton\").attr(\"id\", \"prvw-action\").text(name).appendTo($container);\n    }\n\n    function makeColors($container) {\n        for(var i = 0; i < _colorLang.length; i++) {\n            let $color = $(\"<div>\").attr(\"id\", \"prvw-color\").text(_colorLang[i].lang);\n            let key = _colorLang[i].key;\n\n            let $input = $(\"<input>\").attr(\"type\", \"text\").appendTo($color);\n\n            $input.spectrum({\n                showInitial: true,\n                showInput: true,\n                preferredFormat: \"hex\",\n                replacerClassName: \"prvw-spectrum\",\n                move: function(color) {\n                    _currentColors[key] = color.toHexString();\n                    _$mainContainer.trigger(\"prvw-colors-changed\");\n                }\n            })\n\n            $color.appendTo($container);\n\n            _colors[_colorLang[i].key] = $input;\n        }\n    }\n\n    function fillTopContainer($topContainer) {\n        let $colorContainer = $(\"<div>\").attr(\"id\", \"prvw-colors\").appendTo($topContainer);\n        let $actionContainer = $(\"<div>\").attr(\"id\", \"prvw-actions\").appendTo($topContainer);\n\n        makeColors($colorContainer);\n\n        _$save = makeAction($actionContainer, \"Save\");\n        _$discard = makeAction($actionContainer, \"Discard\");\n        _$default = makeAction($actionContainer, \"Default\");\n        _$exit = makeAction($actionContainer, \"Exit Preview\");\n\n        $(\"<div>\").css(\"padding-left\", \"10px\")\n                  .css(\"padding-bottom\", \"5px\")\n                  .text(\"Note: Saved changes will take effect only after refreshing.\")\n                  .appendTo($topContainer);\n    }\n\n    function fillBottomContainer($bottomContainer) {\n        _$collapseButton = $(\"<div>\").attr(\"id\", \"prvw-collapse\").text(\"Preview Mode!\").appendTo($bottomContainer);\n    }\n\n    function buildContainers() {\n        _$mainContainer = $(\"<div>\").attr(\"id\", \"prvw-container\");\n        \n        let $topContainer = $(\"<div>\").attr(\"id\", \"prvw-top\").appendTo(_$mainContainer);\n        let $bottomContainer = $(\"<div>\").appendTo(_$mainContainer);\n\n        fillTopContainer($topContainer);\n        fillBottomContainer($bottomContainer);\n\n        _$mainContainer.appendTo($(\".gameBoard\"));\n    }\n\n    function bindEvents() {\n        _$collapseButton.click(function (e) {\n            e.stopPropagation();\n\n            if(_isExit) return;\n\n            let options = {duration: 600, queue: false};\n\n            if(_isCollapsed) {\n                _$mainContainer.animate({top: 0}, options);\n                _isCollapsed = false;\n            } else {\n                let target = _$mainContainer.outerHeight() - _$collapseButton.outerHeight() + 1;\n\n                _$mainContainer.animate({top: -target}, options);\n                _isCollapsed = true;\n            }\n        });\n\n        _$mainContainer.on(\"keyup keydown keypress\", function(e) {\n            e.stopPropagation();\n        });\n\n        $(\".sp-container\").on(\"keyup keydown keypress\", function(e) {\n            e.stopPropagation();\n        })\n\n        _$discard.on(\"click\", function(e) {\n            e.stopPropagation();\n\n            _this.setColors(_initialColors);\n        })\n\n        _$save.on(\"click\", function(e) {\n            e.stopPropagation();\n\n            _initialColors = $.extend({}, _currentColors);\n            _$mainContainer.trigger(\"prvw-colors-saved\");\n        });\n\n        _$default.on(\"click\", function(e) {\n            e.stopPropagation();\n\n            let cache = $.extend({}, _initialColors);\n            _this.setColors(_defaults);\n            _initialColors = cache;\n        });\n\n        _$exit.on(\"click\", function(e) {\n            e.stopPropagation();\n\n            if(_isExit) return;\n\n            let options = {duration: 600, queue: false, complete: function() {\n                if(_isExit)\n                    _$mainContainer.hide();\n            }};\n\n            _isExit = true;\n            _$mainContainer.animate({top: -_$mainContainer.outerHeight()}, options);\n\n            _$mainContainer.trigger(\"prvw-exited\");\n        });\n    }\n\n    _this.init = function() {\n        if(_isInit) return;\n\n        buildContainers();\n        bindEvents();\n\n        _$mainContainer.css(\"top\", (-_$mainContainer.outerHeight()) + \"px\");\n        _$mainContainer.hide();\n\n        _isExit = true;\n\n        _isInit = true;\n    }\n\n    _this.getColors = function() {\n        return $.extend({}, Cell.ScytheVisionColors, _currentColors);\n    }\n\n    _this.setColors = function(colors) {\n        if(!_isInit) return;\n\n        colors = colors || {};\n\n        for(let color in colors) {\n            if(_colors[color]) {\n                _colors[color].spectrum(\"set\", colors[color]);\n                _initialColors[color] = colors[color];\n                _currentColors[color] = colors[color];\n            }\n        }\n\n        _$mainContainer.trigger(\"prvw-colors-changed\");\n    }\n\n    _this.getContainer = function() {\n        return _$mainContainer;\n    }\n\n    _this.show = function() {\n        if(!_isExit) return;\n\n        _isExit = false;\n        _isCollapsed = false;\n\n        let options = {duration: 600, queue: false};\n\n        _$mainContainer.show();\n        _$mainContainer.animate({top: 0}, options);\n    }\n}\n\nexport { ColorPickerView }","import { ColorPickerView } from \"./ColorPickerView.js\"\nimport { Setting } from \"../../framework/Setting.js\"\n\nfunction CellColorPicker() {\n    var _view = null;\n    var _this = this;\n    var _$showButton;\n\n    var _setting = new Setting(\"prvw-colors\", $.extend({}, Cell.ScytheVisionColors));\n\n    var _tasks;\n    var _groups;\n    var _tasksRequest;\n    var _heatmapRequest;\n    var _requestsDone;\n    var _isOpen;\n    var _order = [];\n    var _cell;\n    var _originalColorFunc;\n    var _originalUpdateFunc;\n\n    var _accountReady = $.Deferred();\n    var _settingsReady = $.Deferred();\n    var _spectrumReady = $.Deferred();\n\n    function start() {\n        if(_tasksRequest) _tasksRequest.abort();\n        if(_heatmapRequest) _heatmapRequest.abort();\n\n        _tasks = [];\n        _groups = {};\n\n        _cell = tomni.getCurrentCell();\n        _originalColorFunc = _cell.resetTaskColors;\n        _originalUpdateFunc = _cell.updateCompleteColoring;\n        _cell.resetTaskColors = function() {};\n        _cell.updateCompleteColoring = function() {};\n\n        if(_cell.info.tags.ReapGrow) {\n            _order = [\n                \"scythed\",\n                \"complete1\",\n                \"complete2\",\n                \"complete3\",\n                \"review\",\n                \"reap\",\n                \"duplicate\",\n                \"frozen\",\n                \"scythefrozen\"\n            ];\n        } else {\n            _order = [\n                \"complete1\",\n                \"complete2\",\n                \"complete3\",\n                \"review\",\n                \"scythed\",\n                \"reap\",\n                \"duplicate\",\n                \"frozen\",\n                \"scythefrozen\"\n            ]\n        }\n\n        _isOpen = true;\n        _view.show();\n\n        _requestsDone = false;\n\n        _tasksRequest = $.getJSON(\"/1.0/cell/\" + tomni.cell + \"/tasks\").done(processTasks);\n        _heatmapRequest = $.getJSON(\"/1.0/cell/\" + tomni.cell + \"/heatmap/scythe\").done(processHeatmap);\n\n        $.when(_tasksRequest, _heatmapRequest).done(function() {\n            _requestsDone = true;\n            applyColors();\n        });\n    }\n\n    function stop() {\n        // Do some cleanup\n        _isOpen = false;\n\n        if(_tasksRequest)\n            _tasksRequest.abort();\n        if(_heatmapRequest)\n            _heatmapRequest.abort();\n\n        _tasksRequest = null;\n        _heatmapRequest = null;\n\n        if(_cell) {\n            _cell.updateCompleteColoring = _originalUpdateFunc;\n            _cell.resetTaskColors = _originalColorFunc;\n            _cell.resetTaskColors({hard: true});\n        }\n\n        _originalColorFunc = null;\n        _cell = null;\n\n        _tasks = null;\n        _groups = null;\n        _order = null;\n\n        _requestsDone = false;\n    }\n\n    function save() {\n        _setting.setValue($.extend({}, _setting.getValue(), _view.getColors()));\n    }\n\n    function applyColors() {\n        if(!_isOpen || !_requestsDone) return;\n\n        var colors = _view.getColors();\n\n        _cell.colorCubes({cubeids: _tasks, color: ColorUtils.hexToRGB(colors.base), blending: 1});\n\n        for(var i = 0; i < _order.length; i++) {\n            _cell.colorCubes({cubeids: _groups[_order[i]], color: ColorUtils.hexToRGB(colors[_order[i]]), blending: 1});\n        }\n\n        _cell.render();\n    }\n\n    function processTasks(tasks) {\n        _tasks = tasks.tasks.map((task) => task.id);\n    }\n\n    function processHeatmap(heatmap) {\n        _groups.scythed = heatmap.scythed;\n        _groups.reap = heatmap.reaped;\n\n        _groups.complete1 = heatmap.complete.filter((task) => task.votes == 1).map((task) => task.id);\n        _groups.complete2 = heatmap.complete.filter((task) => task.votes == 2).map((task) => task.id);\n        _groups.complete3 = heatmap.complete.filter((task) => task.votes >= 1000000).map((task) => task.id);\n\n        _groups.review = heatmap.review;\n        _groups.frozen = heatmap.frozen;\n        _groups.scythefrozen = heatmap.scythe_frozen;\n        _groups.duplicate = heatmap.duplicate;\n    }\n\n    jQuery.cachedScript = function (url, options) {\n        options = $.extend(options || {}, {\n            dataType: \"script\",\n            cache: true,\n            url: url\n        });\n\n        return jQuery.ajax(options);\n    };\n\n    $(\"<link>\").attr(\"rel\", \"stylesheet\").attr(\"href\", \"https://cdnjs.cloudflare.com/ajax/libs/spectrum/1.8.0/spectrum.min.css\").appendTo($(\"head\"));\n    $.cachedScript(\"https://cdnjs.cloudflare.com/ajax/libs/spectrum/1.8.0/spectrum.min.js\").done(_spectrumReady.resolve);\n\n    _this.getView = function() {\n        return _view;\n    }\n\n    $(document).on(\"ewdlc-account-ready\", _accountReady.resolve);\n\n    $(document).on(\"ewdlc-preferences-loaded.cellColorPicker\", _settingsReady.resolve);\n\n    $.when(_accountReady, _settingsReady, _spectrumReady).then(function() {\n        if(!account.can('scout scythe mystic admin')) return;\n\n        _view = new ColorPickerView($.extend({}, Cell.ScytheVisionColors));\n        _view.init();\n        _view.setColors($.extend({}, _setting.getValue()));\n\n        let $container = _view.getContainer();\n\n        $container.on(\"prvw-exited.cellColorPicker\", stop);\n        $container.on(\"prvw-colors-changed.cellColorPicker\", applyColors);\n        $container.on(\"prvw-colors-saved.cellColorPicker\", save);\n\n        _$showButton = ewdlc.settingsUi.makeButton(\"Show Cell Color Picker\");\n        _$showButton.click(start);\n    });\n\n    $(document).on(\"ewdlc-preferences-loading.cellColorPicker\", function() {\n        ewdlc.preferences.registerSetting(_setting);\n    });\n\n    $(document).on(\"ewdlc-preferences-loaded.cellColorPicker\", function() {\n        $.extend(Cell.ScytheVisionColors, _setting.getValue());\n    });\n}\n\nfunction CellColorPickerInit() {\n    ewdlc.modules.cellColorPicker = ewdlc.modules.cellColorPicker || new CellColorPicker();\n}\n\nexport {CellColorPickerInit}\nexport {CellColorPicker}","function ProfileWindowChanges() {\n    var _$joinedDateSpan = $(\"#profileJoinedDate span\");\n    var _$profUsername = $(\"#profileContainer #profUsername\");\n    var _observer;\n\n    function updateJoinedDate() {\n        var username = _$profUsername.text();\n\n        $.getJSON(\"/1.0/player/\" + username + \"/bio\").done(function(bio) {\n            var joinedMoment = moment(bio.joined * 1000);\n            var nowMoment = moment();\n            var fromNow = joinedMoment.fromNow();\n\n            var $span = $(\"<span>\").text(\" (\" + fromNow + \")\");\n\n            var years = nowMoment.diff(joinedMoment, 'years');\n            nowMoment.add(-years, 'years');\n\n            var months = nowMoment.diff(joinedMoment, 'months');\n            nowMoment.add(-months, 'months');\n\n            var days = nowMoment.diff(joinedMoment, 'days');\n            \n            var arr = [];\n            if(years > 0)\n                arr.push(years + \"y\");\n            \n            if(months > 0)\n                arr.push(months + \"m\");\n\n            if(days > 0)\n                arr.push(days + \"d\");\n\n            if(arr.length > 0)\n                $span.attr(\"title\", arr.join(\", \") + \" ago\");\n\n            _$joinedDateSpan.append($span.hide().fadeIn());\n            _observer.takeRecords();\n        });\n    }\n\n    (function registerObserver() {\n        _observer = new MutationObserver(function(mutations) {\n            mutations.forEach(function(mutation) {\n                if(mutation.addedNodes.length === 0) return;\n                if(_$joinedDateSpan.children(\"span\").length > 0) return;\n\n                updateJoinedDate();\n            });\n        });\n\n        _observer.observe(_$joinedDateSpan[0], {childList: true, characterData: true});\n    })();\n}\n\nfunction ProfileWindowChangesInit() {\n    ewdlc.modules.profileWindowChanges = ewdlc.modules.profileWindowChanges || new ProfileWindowChanges();\n    $(\"body\").append('<script src=\"https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js\" integrity=\"sha256-ABVkpwb9K9PxubvRrHMkk6wmWcIHUE9eBxNZLXYQ84k=\" crossorigin=\"anonymous\"></script>');\n}\n\nexport {ProfileWindowChangesInit}\nexport {ProfileWindowChanges}\n","import * as TabbedChat from \"./tabbedChat/TabbedChat.js\"\nimport * as SkippableLeaderboard from \"./SkippableLeaderboard/SkippableLeaderboard.js\"\nimport * as ExtraStats from \"./ExtraStats/ExtraStats.js\"\nimport * as ExtraControls from \"./ExtraControls/ExtraControls.js\"\nimport * as UiBoxImprovements from \"./UiBoxImprovements/UiBoxImprovements.js\"\nimport * as SlHacks from \"./SlHacks/SlHacks.js\"\nimport * as CellColorPicker from \"./CellColorPicker/CellColorPicker.js\"\nimport * as ProfileWindowChanges from \"./ProfileWindowChanges/ProfileWindowChanges.js\"\n\nvar Modules = {\n    TabbedChat: TabbedChat,\n    SkippableLeaderboard: SkippableLeaderboard,\n    ExtraStats: ExtraStats,\n    ExtraControls: ExtraControls,\n    UiBoxImprovements: UiBoxImprovements,\n    SlHacks: SlHacks,\n    CellColorPicker: CellColorPicker,\n    ProfileWindowChanges: ProfileWindowChanges\n}\n\nfunction initModules() {\n    for(var key in Modules) {\n        Modules[key][key + \"Init\"]();\n    }\n}\n\nexport {Modules}\nexport {initModules}\n","import {EWDLC} from \"./framework/ewdlc.js\"\nimport {initModules} from \"./modules/modules.js\"\n\n$(document).ready(function () {\n    if($(\".gameBoard\").length == 0) return;\n\n    window.ewdlc = new EWDLC(\"https://chrisraven.github.io/EWDLC/build/static\");\n\n    initModules();\n    ewdlc.init();\n});\n\n\nexport * from \"./framework/ewdlc.js\"\nexport {Modules} from \"./modules/modules.js\"\n"]}